# è´¢åŠ¡ç®¡ç†ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ

## æ ¸å¿ƒè®¾è®¡åŸåˆ™
- **ç²¾ç®€ä½†å®Œæ•´**ï¼šè¦†ç›–æ‰€æœ‰æ”¯å‡ºç±»å‹ï¼Œä½†ä¿æŒç»“æ„ç®€å•
- **ä¸“ä¸šåˆè§„**ï¼šæ”¯æŒè´¢åŠ¡æŠ¥è¡¨å’Œç¨åŠ¡ç”³æŠ¥
- **çµæ´»æ‰©å±•**ï¼šæ˜“äºæ·»åŠ æ–°çš„æ”¯å‡ºç±»å‹å’Œä¾›åº”å•†ç±»å‹

## æ•°æ®åº“è¡¨ç»“æ„

### 1. suppliersï¼ˆé€šç”¨ä¾›åº”å•†è¡¨ï¼‰
**ç”¨é€”**ï¼šç®¡ç†æ‰€æœ‰ç±»å‹çš„ä¾›åº”å•†ï¼ˆåŸææ–™ã€æœåŠ¡ã€è®¾å¤‡ã€å…¶ä»–ï¼‰

```sql
CREATE TABLE suppliers (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    
    -- åŸºæœ¬ä¿¡æ¯
    name VARCHAR(255) NOT NULL UNIQUE,
    aliases TEXT[] DEFAULT '{}',  -- OCRè¯†åˆ«åˆ«åï¼ˆä¸»è¦ç”¨äºåŸææ–™ä¾›åº”å•†ï¼‰
    
    -- ä¾›åº”å•†ç±»å‹
    supplier_type VARCHAR(50) NOT NULL,  -- 'raw_material', 'service', 'equipment', 'rent', 'utility', 'other'
    
    -- GSTç›¸å…³
    is_price_inclusive_gst BOOLEAN DEFAULT true,  -- ä»·æ ¼æ˜¯å¦å«GST
    abn VARCHAR(20),  -- ä¾›åº”å•†ABNï¼ˆç”¨äºGSTï¼‰
    
    -- è”ç³»ä¿¡æ¯
    address TEXT,
    contact_number VARCHAR(50),
    email VARCHAR(255),
    
    -- å…¶ä»–
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_suppliers_name ON suppliers(name);
CREATE INDEX idx_suppliers_type ON suppliers(supplier_type);
CREATE INDEX idx_suppliers_aliases ON suppliers USING GIN(aliases);
```

### 2. expensesï¼ˆé€šç”¨æ”¯å‡ºè¡¨ï¼‰
**ç”¨é€”**ï¼šè®°å½•æ‰€æœ‰ç±»å‹çš„æ”¯å‡ºï¼ˆåŸææ–™ã€æœåŠ¡ã€è®¾å¤‡ã€ç§Ÿé‡‘ã€æ°´ç”µç­‰ï¼‰

```sql
CREATE TABLE expenses (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    
    -- å…³è”ä¿¡æ¯
    supplier_id UUID REFERENCES suppliers(id) ON DELETE SET NULL,
    supplier_name VARCHAR(255) NOT NULL,  -- å†—ä½™å­—æ®µï¼Œä¾¿äºæŸ¥è¯¢å’ŒæŠ¥è¡¨
    
    -- æ”¯å‡ºä¿¡æ¯
    expense_date DATE NOT NULL,  -- æ”¯å‡ºæ—¥æœŸ
    expense_type VARCHAR(50) NOT NULL,  -- 'raw_material', 'service', 'equipment', 'rent', 'utility', 'packaging', 'marketing', 'professional_service', 'license', 'salary', 'other'
    
    -- é‡‘é¢ä¿¡æ¯
    receipt_total_amount DECIMAL(10,2),  -- æ”¶æ®æ€»ä»·ï¼ˆä»OCRè¯†åˆ«ï¼ŒåŸå§‹æ”¶æ®æ€»ä»·ï¼Œä¸ä¼šå› å•†å“é€‰æ‹©è€Œæ”¹å˜ï¼‰
    total_amount DECIMAL(10,2) NOT NULL,  -- æ€»é‡‘é¢ï¼ˆå«GSTï¼Œå¯èƒ½æ ¹æ®é€‰ä¸­çš„å•†å“é¡¹æ›´æ–°ï¼‰
    gst_amount DECIMAL(10,2) DEFAULT 0,  -- GSTé‡‘é¢
    net_amount DECIMAL(10,2) NOT NULL,  -- å‡€é‡‘é¢ï¼ˆä¸å«GSTï¼‰= total_amount - gst_amount
    
    -- æ”¶æ®/å‘ç¥¨ä¿¡æ¯
    receipt_number VARCHAR(100),  -- æ”¶æ®/å‘ç¥¨å·
    receipt_image_path VARCHAR(500),  -- æ”¶æ®å›¾ç‰‡è·¯å¾„ï¼ˆä¸»è¦ç”¨äºåŸææ–™ï¼Œæ”¯æŒOCRï¼‰
    
    -- OCRç›¸å…³ï¼ˆä¸»è¦ç”¨äºraw_materialç±»å‹ï¼‰
    items JSONB,  -- å•†å“æ˜ç»†åˆ—è¡¨ï¼ˆJSONBæ ¼å¼ï¼Œä¸»è¦ç”¨äºåŸææ–™æ”¯å‡ºï¼‰
    ocr_raw_data JSONB,  -- OCRåŸå§‹æ•°æ®ï¼ˆç”¨äºè°ƒè¯•å’Œé‡æ–°åˆ†æï¼‰
    ocr_raw_data_temp JSONB,  -- OCRåŸå§‹æ•°æ®ä¸´æ—¶å­˜å‚¨ï¼ˆç”¨äºé‡æ–°è¯†åˆ«ï¼‰
    
    -- è®¾å¤‡å…³è”ï¼ˆå¦‚æœæ˜¯è®¾å¤‡æ”¯å‡ºï¼‰
    equipment_id UUID,  -- å…³è”equipmentè¡¨ï¼ˆå¦‚æœexpense_type = 'equipment'ï¼‰
    
    -- å…¶ä»–ä¿¡æ¯
    notes TEXT,  -- å¤‡æ³¨
    
    -- ä¸šåŠ¡ç±»å‹ï¼ˆä¸ªäºº/å…¬å¸ï¼‰
    business_type VARCHAR(20) DEFAULT 'company',  -- 'personal', 'company'
    
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_expenses_date ON expenses(expense_date);
CREATE INDEX idx_expenses_type ON expenses(expense_type);
CREATE INDEX idx_expenses_supplier_id ON expenses(supplier_id);
CREATE INDEX idx_expenses_equipment_id ON expenses(equipment_id);
CREATE INDEX idx_expenses_business_type ON expenses(business_type);
CREATE INDEX idx_expenses_receipt_total_amount ON expenses(receipt_total_amount);
CREATE INDEX idx_expenses_items ON expenses USING GIN(items);
```

### 3. equipmentï¼ˆè®¾å¤‡è¡¨ï¼‰
**ç”¨é€”**ï¼šç®¡ç†è®¾å¤‡èµ„äº§ï¼Œç”¨äºæŠ˜æ—§è®¡ç®—

```sql
CREATE TABLE equipment (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    
    -- åŸºæœ¬ä¿¡æ¯
    name VARCHAR(255) NOT NULL,
    description TEXT,
    category VARCHAR(100),  -- è®¾å¤‡ç±»åˆ«ï¼ˆå¦‚ï¼š'oven', 'mixer', 'refrigerator', 'office_equipment'ç­‰ï¼‰
    
    -- é‡‡è´­ä¿¡æ¯
    purchase_date DATE NOT NULL,
    purchase_price DECIMAL(10,2) NOT NULL,  -- è´­ä¹°ä»·æ ¼ï¼ˆä¸å«GSTï¼‰
    purchase_gst DECIMAL(10,2) DEFAULT 0,  -- è´­ä¹°æ—¶çš„GST
    supplier_id UUID REFERENCES suppliers(id) ON DELETE SET NULL,
    
    -- å…³è”æ”¯å‡ºè®°å½•
    expense_id UUID REFERENCES expenses(id) ON DELETE SET NULL,  -- å…³è”åˆ°expensesè¡¨
    
    -- æŠ˜æ—§ä¿¡æ¯
    depreciation_method VARCHAR(50) DEFAULT 'instant_write_off',  -- 'instant_write_off', 'straight_line', 'diminishing_balance_standard', 'diminishing_balance_low_value_pool'
    useful_life_years INTEGER,  -- é¢„è®¡ä½¿ç”¨å¹´é™ï¼ˆç”¨äºç›´çº¿æŠ˜æ—§ï¼‰
    is_depreciated BOOLEAN DEFAULT false,  -- æ˜¯å¦å·²å®Œå…¨æŠ˜æ—§
    
    -- å½“å‰ä»·å€¼
    current_book_value DECIMAL(10,2),  -- å½“å‰è´¦é¢ä»·å€¼
    accumulated_depreciation DECIMAL(10,2) DEFAULT 0,  -- ç´¯è®¡æŠ˜æ—§
    
    -- çŠ¶æ€
    status VARCHAR(50) DEFAULT 'active',  -- 'active', 'disposed', 'written_off'
    disposal_date DATE,
    disposal_value DECIMAL(10,2),  -- å¤„ç½®ä»·å€¼
    
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_equipment_purchase_date ON equipment(purchase_date);
CREATE INDEX idx_equipment_status ON equipment(status);
CREATE INDEX idx_equipment_expense_id ON equipment(expense_id);
```

### 4. equipment_depreciation_recordsï¼ˆè®¾å¤‡æŠ˜æ—§è®°å½•è¡¨ï¼‰
**ç”¨é€”**ï¼šè®°å½•æ¯å¹´çš„æŠ˜æ—§æ˜ç»†ï¼Œç”¨äºç¨åŠ¡ç”³æŠ¥

```sql
CREATE TABLE equipment_depreciation_records (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    
    -- å…³è”ä¿¡æ¯
    equipment_id UUID NOT NULL REFERENCES equipment(id) ON DELETE CASCADE,
    financial_year VARCHAR(10) NOT NULL,  -- è´¢å¹´ï¼ˆå¦‚ï¼š'2024-25'ï¼‰
    
    -- æŠ˜æ—§ä¿¡æ¯
    depreciation_method VARCHAR(50) NOT NULL,  -- ä½¿ç”¨çš„æŠ˜æ—§æ–¹æ³•
    opening_value DECIMAL(10,2) NOT NULL,  -- æœŸåˆè´¦é¢ä»·å€¼
    depreciation_amount DECIMAL(10,2) NOT NULL,  -- æœ¬å¹´æŠ˜æ—§é‡‘é¢
    closing_value DECIMAL(10,2) NOT NULL,  -- æœŸæœ«è´¦é¢ä»·å€¼
    
    -- è®¡ç®—åˆå§‹å€¼ï¼ˆJSONæ ¼å¼ï¼Œä¿å­˜è®¡ç®—æ—¶çš„å®Œæ•´ä¿¡æ¯ï¼‰
    calculated_initial_data JSONB,  -- ä¿å­˜é¦–æ¬¡è®¡ç®—æ—¶çš„å®Œæ•´æ•°æ®ï¼Œç”¨äºéªŒè¯å’Œè¿½æº¯
    
    -- æŠ¥è¡¨ç¡®è®¤æ ‡è®°
    is_committed BOOLEAN DEFAULT false,  -- æ˜¯å¦å·²ç”¨äºæŠ¥è¡¨ï¼ˆå·²ç¡®è®¤ï¼‰
    committed_at TIMESTAMP WITH TIME ZONE,  -- ç¡®è®¤æ—¶é—´
    committed_by UUID,  -- ç¡®è®¤äººID
    commit_note TEXT,  -- ç¡®è®¤å¤‡æ³¨ï¼ˆå¦‚ï¼š"2024-25è´¢å¹´ç¨åŠ¡æŠ¥è¡¨"ï¼‰
    
    -- è°ƒæ•´è®°å½•ï¼ˆå¦‚æœç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹è¿‡ï¼‰
    is_adjusted BOOLEAN DEFAULT false,  -- æ˜¯å¦æ‰‹åŠ¨è°ƒæ•´è¿‡
    adjustment_reason TEXT,  -- è°ƒæ•´åŸå› 
    adjusted_at TIMESTAMP WITH TIME ZONE,  -- è°ƒæ•´æ—¶é—´
    
    -- å…¶ä»–
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    
    -- å”¯ä¸€çº¦æŸï¼šæ¯ä¸ªè®¾å¤‡æ¯ä¸ªè´¢å¹´åªèƒ½æœ‰ä¸€æ¡è®°å½•
    UNIQUE(equipment_id, financial_year)
);

CREATE INDEX idx_equipment_depreciation_equipment_id ON equipment_depreciation_records(equipment_id);
CREATE INDEX idx_equipment_depreciation_financial_year ON equipment_depreciation_records(financial_year);
CREATE INDEX idx_equipment_depreciation_committed ON equipment_depreciation_records(is_committed);
```

**calculated_initial_data JSONç»“æ„**ï¼š
```json
{
  "calculationDate": "2025-01-15T10:30:00Z",
  "calculationVersion": 1,
  "equipmentSnapshot": {
    "id": "equipment-uuid",
    "depreciationMethod": "straight_line",
    "usefulLifeYears": 5,
    "purchasePrice": 10000,
    "purchaseDate": "2023-01-15"
  },
  "calculationParams": {
    "openingValue": 8000,
    "source": "previous_year_record",
    "previousYearRecordId": "record-uuid",
    "previousFinancialYear": "2023-24",
    "method": "straight_line",
    "usefulLifeYears": 5,
    "lowValueThreshold": 300
  },
  "calculatedResult": {
    "depreciationAmount": 2000,
    "closingValue": 6000
  }
}
```

## æ•°æ®å…³ç³»

```
suppliers (1) â”€â”€< (N) expenses
equipment (1) â”€â”€< (N) equipment_depreciation_records
expenses (1) â”€â”€< (0..1) equipment  (è®¾å¤‡æ”¯å‡ºå…³è”åˆ°equipment)
```

## æ”¯å‡ºç±»å‹åˆ†ç±»

### expense_type æšä¸¾å€¼ï¼š
- `raw_material` - åŸææ–™
- `packaging` - åŒ…è£…ææ–™
- `equipment` - è®¾å¤‡ï¼ˆä¼šå…³è”åˆ°equipmentè¡¨ï¼‰
- `service` - æœåŠ¡ï¼ˆä¼šè®¡ã€æ³•å¾‹ã€å’¨è¯¢ç­‰ï¼‰
- `rent` - ç§Ÿé‡‘
- `utility` - æ°´ç”µè´¹
- `marketing` - è¥é”€æ¨å¹¿
- `professional_service` - ä¸“ä¸šæœåŠ¡ï¼ˆä¼šè®¡ã€æ³•å¾‹ç­‰ï¼‰
- `license` - è®¸å¯è¯/æ³¨å†Œè´¹
- `salary` - å·¥èµ„ï¼ˆå¦‚æœè®°å½•å‘˜å·¥å·¥èµ„ï¼‰
- `transport` - è¿è¾“ï¼ˆä½¿ç”¨æŸä¸ªå…¬å¸çš„ç‰©æµå¿«é€’è¿è¾“æœåŠ¡ï¼‰
- `delivery` - å¤–é€ï¼ˆæ”¯ä»˜ç»™ç¬¬ä¸‰æ–¹å¸®æˆ‘é€è´§çš„å¿«é€’è´¹ï¼‰
- `other` - å…¶ä»–

### supplier_type æšä¸¾å€¼ï¼š
- `raw_material` - åŸææ–™ä¾›åº”å•†
- `service` - æœåŠ¡æä¾›å•†
- `equipment` - è®¾å¤‡ä¾›åº”å•†
- `rent` - æˆ¿ä¸œ
- `utility` - æ°´ç”µå…¬å¸
- `transport` - è¿è¾“æœåŠ¡æä¾›å•†
- `other` - å…¶ä»–

## å…³é”®åŠŸèƒ½

### 1. æ”¯å‡ºè®°å½•
- æ”¯æŒæ‰€æœ‰ç±»å‹çš„æ”¯å‡º
- è‡ªåŠ¨è®¡ç®—GSTï¼ˆå¦‚æœå«GSTï¼‰
- æ”¯æŒæ”¶æ®å›¾ç‰‡ä¸Šä¼ ï¼ˆä¸»è¦ç”¨äºåŸææ–™ï¼Œæ”¯æŒOCRï¼‰
- **OCRè¯†åˆ«åŠŸèƒ½**ï¼ˆä»…é™ `raw_material` ç±»å‹ï¼‰ï¼š
  - è‡ªåŠ¨è¯†åˆ«æ”¶æ®ä¿¡æ¯ï¼ˆä¾›åº”å•†ã€æ—¥æœŸã€**å‘ç¥¨å·**ã€å•†å“åˆ—è¡¨ã€é‡‘é¢ç­‰ï¼‰
  - ä¾›åº”å•†è‡ªåŠ¨åŒ¹é…ï¼ˆé€šè¿‡åç§°æˆ–åˆ«åï¼‰
  - å•†å“é¡¹è‡ªåŠ¨æ ‡è®°ï¼ˆOCRè¯†åˆ«çš„ä¸å¯åˆ é™¤ï¼Œæ‰‹åŠ¨æ·»åŠ çš„å¯åˆ é™¤ï¼‰
  - æ”¯æŒé‡æ–°è¯†åˆ«å’Œé‡æ–°åˆ†æ
  - OCRå¤±è´¥æ—¶è‡ªåŠ¨åˆ é™¤S3å›¾ç‰‡ï¼ˆåªæœ‰æˆåŠŸçš„OCRæ‰ä¼šä¿ç•™è®°å½•ï¼‰
  - **é‡‘é¢è®¡ç®—**ï¼šæ ¹æ®ä¾›åº”å•†çš„ `isPriceInclusiveGst` å’Œé€‰ä¸­å•†å“é¡¹è‡ªåŠ¨è®¡ç®—æ€»é‡‘é¢ã€GSTé‡‘é¢å’Œå‡€é‡‘é¢
- **æ‰‹åŠ¨è¾“å…¥æ¨¡å¼**ï¼š
  - æ”¯æŒæ‰‹åŠ¨ä¸Šä¼ å›¾ç‰‡ï¼ˆä¸è¿›è¡ŒOCRè¯†åˆ«ï¼Œé€‚ç”¨äºä¸­æ–‡æ”¶æ®ï¼‰
  - æ‰‹åŠ¨æ·»åŠ å•†å“é¡¹ï¼ˆæ ‡è®°ä¸ºå¯åˆ é™¤ï¼‰

### 2. è®¾å¤‡ç®¡ç†
- è®°å½•è®¾å¤‡é‡‡è´­
- è‡ªåŠ¨å…³è”åˆ°æ”¯å‡ºè®°å½•
- æ”¯æŒå¤šç§æŠ˜æ—§æ–¹æ³•
- è‡ªåŠ¨è®¡ç®—æŠ˜æ—§

### 3. æŠ˜æ—§è®¡ç®—

#### 3.1 æŠ˜æ—§æ–¹æ³•ï¼ˆåŸºäºæ¾³æ´²ATOæ”¿ç­–ï¼‰

**æ¾³æ´²ç¨åŠ¡å±€ï¼ˆATOï¼‰è®¤å¯çš„æŠ˜æ—§æ–¹æ³•**ï¼š

1. **ä¸€æ¬¡æ€§æŠ˜æ—§ï¼ˆInstant Asset Write-Off / instant_write_offï¼‰**
   - **ATOæ”¿ç­–**ï¼šå³æ—¶èµ„äº§æ‰£é™¤æ”¿ç­–ï¼Œå…è®¸ç¬¦åˆæ¡ä»¶çš„èµ„äº§åœ¨è´­ä¹°å½“å¹´å…¨é¢æ‰£é™¤
   - **é€‚ç”¨æ¡ä»¶**ï¼š
     - èµ„äº§å¿…é¡»ç”¨äºäº§ç”Ÿå¯è¯„ä¼°æ”¶å…¥ï¼ˆassessable incomeï¼‰çš„ä¸šåŠ¡æ´»åŠ¨
     - èµ„äº§ä»·å€¼éœ€åœ¨æ”¿ç­–è§„å®šçš„é˜ˆå€¼å†…ï¼ˆæ”¿ç­–ä¼šå˜åŒ–ï¼Œéœ€æŸ¥è¯¢æœ€æ–°è§„å®šï¼‰
     - é€šå¸¸é€‚ç”¨äºå°å‹ä¼ä¸šï¼ˆå¹´è¥ä¸šé¢ä½äºç‰¹å®šé—¨æ§›ï¼Œå¦‚$10 millionï¼‰
     - èµ„äº§å¿…é¡»åœ¨ç‰¹å®šæ—¥æœŸå‰è´­ä¹°å’Œå®‰è£…
   - **é™åˆ¶**ï¼š
     - æ”¿ç­–æ˜¯ä¸´æ—¶æ€§çš„ï¼Œæ¯å¹´å¯èƒ½å˜åŒ–æˆ–å–æ¶ˆ
     - æœ‰èµ„äº§ä»·å€¼ä¸Šé™ï¼ˆå¦‚$20,000, $30,000ç­‰ï¼Œéœ€æŸ¥è¯¢æœ€æ–°æ”¿ç­–ï¼‰
     - æŸäº›èµ„äº§ç±»å‹ä¸é€‚ç”¨ï¼ˆå¦‚å»ºç­‘ç‰©ã€æŸäº›è½¦è¾†ç­‰ï¼‰
     - ä¸€æ—¦é€‰æ‹©æ­¤æ–¹æ³•ï¼Œèµ„äº§æˆæœ¬åœ¨å½“å¹´å…¨é¢æ‰£é™¤ï¼Œåç»­å¹´åº¦æ— æŠ˜æ—§

2. **é€’å‡ä½™é¢æ³•ï¼ˆDiminishing Value Methodï¼‰**

   ATOæä¾›ä¸¤ç§é€’å‡ä½™é¢æ³•ï¼š

   **a) æ ‡å‡†é€’å‡ä½™é¢æ³•ï¼ˆdiminishing_balance_standardï¼Œèµ„äº§ä»·å€¼ > $1,000ï¼‰**ï¼š
   
   - **åŸºæœ¬åŸç†**ï¼šæ¯å¹´æŒ‰èµ„äº§è´¦é¢ä»·å€¼ï¼ˆæœªæŠ˜æ—§ä½™é¢ï¼‰çš„å›ºå®šç™¾åˆ†æ¯”è¿›è¡ŒæŠ˜æ—§ï¼Œå‰æœŸæŠ˜æ—§é¢é«˜ï¼ŒåæœŸé€æ¸å‡å°‘
   - **ATOæ ‡å‡†å…¬å¼**ï¼š
     ```
     æŠ˜æ—§ç‡ = 200% / æœ‰æ•ˆä½¿ç”¨å¹´é™ï¼ˆEffective Lifeï¼‰
     å¹´æŠ˜æ—§é¢ = æœŸåˆè´¦é¢ä»·å€¼ Ã— æŠ˜æ—§ç‡
     æœŸæœ«è´¦é¢ä»·å€¼ = æœŸåˆè´¦é¢ä»·å€¼ - å¹´æŠ˜æ—§é¢
     ```
   - **ç¤ºä¾‹**ï¼ˆèµ„äº§æˆæœ¬ $10,000ï¼Œæœ‰æ•ˆä½¿ç”¨å¹´é™ 5å¹´ï¼‰ï¼š
     ```
     æŠ˜æ—§ç‡ = 200% / 5 = 40%
     
     ç¬¬1å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$10,000
       æŠ˜æ—§é¢ï¼š$10,000 Ã— 40% = $4,000
       æœŸæœ«ä»·å€¼ï¼š$10,000 - $4,000 = $6,000
     
     ç¬¬2å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$6,000ï¼ˆä¸Šä¸€å¹´çš„æœŸæœ«ä»·å€¼ï¼‰
       æŠ˜æ—§é¢ï¼š$6,000 Ã— 40% = $2,400
       æœŸæœ«ä»·å€¼ï¼š$6,000 - $2,400 = $3,600
     
     ç¬¬3å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$3,600
       æŠ˜æ—§é¢ï¼š$3,600 Ã— 40% = $1,440
       æœŸæœ«ä»·å€¼ï¼š$3,600 - $1,440 = $2,160
     
     ç¬¬4å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$2,160
       æŠ˜æ—§é¢ï¼š$2,160 Ã— 40% = $864
       æœŸæœ«ä»·å€¼ï¼š$2,160 - $864 = $1,296
     
     ç¬¬5å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$1,296
       æŠ˜æ—§é¢ï¼š$1,296 Ã— 40% = $518.40
       æœŸæœ«ä»·å€¼ï¼š$1,296 - $518.40 = $777.60
     
     åç»­å¹´åº¦ç»§ç»­æŒ‰40%æŠ˜æ—§ï¼Œç†è®ºä¸Šæ°¸è¿œä¸ä¼šå®Œå…¨æŠ˜æ—§åˆ°0
     ```

   **b) ä½ä»·å€¼èµ„äº§æ± ï¼ˆdiminishing_balance_low_value_poolï¼Œèµ„äº§ä»·å€¼ â‰¤ $1,000ï¼‰**ï¼š
   
   **ATOä½ä»·å€¼èµ„äº§æ± ï¼ˆLow-Value Poolï¼‰è§„åˆ™**ï¼š
   
   - **é€‚ç”¨æ¡ä»¶**ï¼šèµ„äº§ä»·å€¼ â‰¤ $1,000 å¯åŠ å…¥ä½ä»·å€¼èµ„äº§æ± 
   - **æŠ˜æ—§ç‡**ï¼š
     - ç¬¬ä¸€å¹´ï¼š37.5%
     - åç»­å¹´åº¦ï¼š18.75%
   - **ç‰¹æ®Šè§„åˆ™**ï¼šå½“èµ„äº§æ± ä½™é¢ â‰¤ $300 æ—¶ï¼Œå¯ä»¥ä¸€æ¬¡æ€§å…¨éƒ¨æ‰£é™¤
   - **ç¤ºä¾‹**ï¼ˆèµ„äº§ä»·å€¼ $1,000ï¼‰ï¼š
     ```
     ç¬¬1å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$1,000
       æŠ˜æ—§é¢ï¼š$1,000 Ã— 37.5% = $375
       æœŸæœ«ä»·å€¼ï¼š$1,000 - $375 = $625
     
     ç¬¬2å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$625
       æŠ˜æ—§é¢ï¼š$625 Ã— 18.75% = $117.19
       æœŸæœ«ä»·å€¼ï¼š$625 - $117.19 = $507.81
     
     ç¬¬3å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$507.81
       æŠ˜æ—§é¢ï¼š$507.81 Ã— 18.75% = $95.21
       æœŸæœ«ä»·å€¼ï¼š$507.81 - $95.21 = $412.60
     
     ç¬¬4å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$412.60
       æŠ˜æ—§é¢ï¼š$412.60 Ã— 18.75% = $77.36
       æœŸæœ«ä»·å€¼ï¼š$412.60 - $77.36 = $335.24
     
     ç¬¬5å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$335.24
       æŠ˜æ—§é¢ï¼š$335.24 Ã— 18.75% = $62.86
       æœŸæœ«ä»·å€¼ï¼š$335.24 - $62.86 = $272.38
     
     ç¬¬6å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$272.38
       ç”±äº $272.38 â‰¤ $300ï¼Œä¸€æ¬¡æ€§å…¨éƒ¨æ‰£é™¤
       æŠ˜æ—§é¢ï¼š$272.38ï¼ˆå…¨éƒ¨ï¼‰
       æœŸæœ«ä»·å€¼ï¼š$0
     ```
   
   **ç³»ç»Ÿå®ç°è¯´æ˜**ï¼š
   
   - **æ ‡å‡†é€’å‡ä½™é¢æ³•ï¼ˆdiminishing_balance_standardï¼‰**ï¼šå®Œå…¨æŒ‰ç…§ATOæ ‡å‡†å®ç°ï¼Œä½¿ç”¨200% / æœ‰æ•ˆä½¿ç”¨å¹´é™ä½œä¸ºæŠ˜æ—§ç‡
   - **ä½ä»·å€¼èµ„äº§æ± ï¼ˆdiminishing_balance_low_value_poolï¼‰**ï¼šå®Œå…¨æŒ‰ç…§ATOæ ‡å‡†å®ç°ï¼Œç¬¬ä¸€å¹´37.5%ï¼Œåç»­å¹´åº¦18.75%ï¼Œä½™é¢â‰¤$300æ—¶ä¸€æ¬¡æ€§æ‰£é™¤
   
   | é¡¹ç›® | æ ‡å‡†é€’å‡ä½™é¢æ³• | ä½ä»·å€¼èµ„äº§æ±  |
   |------|----------------|-------------|
   | æŠ˜æ—§ç‡ | 200% / æœ‰æ•ˆä½¿ç”¨å¹´é™ | ç¬¬ä¸€å¹´37.5%ï¼Œåç»­18.75% |
   | éœ€è¦æœ‰æ•ˆä½¿ç”¨å¹´é™ | âœ… æ˜¯ | âŒ å¦ |
   | $300é˜ˆå€¼è§„åˆ™ | âŒ æ—  | âœ… æœ‰ï¼ˆä½™é¢â‰¤$300æ—¶ä¸€æ¬¡æ€§æ‰£é™¤ï¼‰ |
   | é€‚ç”¨èµ„äº§ä»·å€¼ | > $1,000 | â‰¤ $1,000 |
   | è®¡ç®—å¤æ‚åº¦ | è¾ƒé«˜ | ä¸­ç­‰ |
   
   **é€‚ç”¨æ¡ä»¶**ï¼š
   - é€‚ç”¨äºæ‰€æœ‰ç”¨äºäº§ç”Ÿå¯è¯„ä¼°æ”¶å…¥çš„ä¸šåŠ¡èµ„äº§
   - èµ„äº§éœ€æœ‰ATOè§„å®šçš„æœ‰æ•ˆä½¿ç”¨å¹´é™ï¼ˆEffective Lifeï¼‰ï¼ˆæ ‡å‡†é€’å‡ä½™é¢æ³•ï¼‰
   - é€‚ç”¨äºæŠ€æœ¯æ›´æ–°è¾ƒå¿«çš„èµ„äº§ï¼ˆå¦‚ç”µè„‘ã€è®¾å¤‡ç­‰ï¼‰
   - å‰æœŸéœ€è¦æ›´å¤šç¨åŠ¡æŠµæ‰£çš„ä¼ä¸š
   
   **ä¼˜åŠ¿**ï¼š
   - å‰æœŸæŠ˜æ—§é¢é«˜ï¼Œç¨åŠ¡æŠµæ‰£å¤š
   - é€‚åˆæŠ€æœ¯æ›´æ–°å¿«çš„èµ„äº§
   - ç¬¦åˆèµ„äº§å®é™…ä»·å€¼é€’å‡è§„å¾‹
   
   **é™åˆ¶**ï¼š
   - ä¸€æ—¦é€‰æ‹©é€’å‡ä½™é¢æ³•ï¼Œå¿…é¡»åœ¨èµ„äº§æ•´ä¸ªä½¿ç”¨æœŸé—´ä¿æŒä¸€è‡´
   - ä¸èƒ½ä¸­é€”æ”¹ä¸ºç›´çº¿æ³•
   - éœ€è¦æ ¹æ®ATOçš„æœ‰æ•ˆä½¿ç”¨å¹´é™è¡¨ç¡®å®šæŠ˜æ—§ç‡ï¼ˆæ ‡å‡†é€’å‡ä½™é¢æ³•ï¼‰
   - ç†è®ºä¸Šæ°¸è¿œä¸ä¼šå®Œå…¨æŠ˜æ—§åˆ°0ï¼ˆé™¤éä½¿ç”¨$300é˜ˆå€¼è§„åˆ™ï¼‰

3. **ç›´çº¿æ³•ï¼ˆPrime Cost Method / Straight Line Method / straight_lineï¼‰**

   **ATOæ ‡å‡†ç›´çº¿æ³•**ï¼š
   
   - **åŸºæœ¬åŸç†**ï¼šå°†èµ„äº§æˆæœ¬åœ¨å…¶æœ‰æ•ˆä½¿ç”¨å¹´é™å†…å¹³å‡åˆ†æ‘Šï¼Œæ¯å¹´è®¡æç›¸åŒçš„æŠ˜æ—§è´¹ç”¨
   - **ATOæ ‡å‡†å…¬å¼**ï¼š
     ```
     å¹´æŠ˜æ—§é¢ = (èµ„äº§æˆæœ¬ - æ®‹å€¼) / æœ‰æ•ˆä½¿ç”¨å¹´é™
     æœŸæœ«è´¦é¢ä»·å€¼ = æœŸåˆè´¦é¢ä»·å€¼ - å¹´æŠ˜æ—§é¢
     ```
   - **æ®‹å€¼ï¼ˆResidual Valueï¼‰**ï¼š
     - èµ„äº§åœ¨ä½¿ç”¨å¹´é™ç»“æŸæ—¶çš„ä¼°è®¡ä»·å€¼
     - é€šå¸¸ä¸º0æˆ–å¾ˆå°çš„é‡‘é¢
     - ç³»ç»Ÿç®€åŒ–å¤„ç†ï¼šæ®‹å€¼é€šå¸¸ä¸º0
   - **ç¤ºä¾‹**ï¼ˆèµ„äº§æˆæœ¬ $10,000ï¼Œæœ‰æ•ˆä½¿ç”¨å¹´é™ 5å¹´ï¼Œæ®‹å€¼ $0ï¼‰ï¼š
     ```
     å¹´æŠ˜æ—§é¢ = ($10,000 - $0) / 5 = $2,000
     
     ç¬¬1å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$10,000
       æŠ˜æ—§é¢ï¼š$2,000
       æœŸæœ«ä»·å€¼ï¼š$10,000 - $2,000 = $8,000
     
     ç¬¬2å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$8,000
       æŠ˜æ—§é¢ï¼š$2,000
       æœŸæœ«ä»·å€¼ï¼š$8,000 - $2,000 = $6,000
     
     ç¬¬3å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$6,000
       æŠ˜æ—§é¢ï¼š$2,000
       æœŸæœ«ä»·å€¼ï¼š$6,000 - $2,000 = $4,000
     
     ç¬¬4å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$4,000
       æŠ˜æ—§é¢ï¼š$2,000
       æœŸæœ«ä»·å€¼ï¼š$4,000 - $2,000 = $2,000
     
     ç¬¬5å¹´ï¼š
       æœŸåˆä»·å€¼ï¼š$2,000
       æŠ˜æ—§é¢ï¼š$2,000
       æœŸæœ«ä»·å€¼ï¼š$2,000 - $2,000 = $0ï¼ˆå®Œå…¨æŠ˜æ—§ï¼‰
     ```
   
   **âš ï¸ é‡è¦å‘ç°ï¼šç³»ç»Ÿå®ç°ä¸ATOæ ‡å‡†ä¸ä¸€è‡´**
   
   - **ATOæ ‡å‡†**ï¼šæ¯å¹´å›ºå®šæŠ˜æ—§é¢ = åŸå§‹æˆæœ¬ / ä½¿ç”¨å¹´é™
   - **ç³»ç»Ÿå½“å‰å®ç°**ï¼šæ¯å¹´æŠ˜æ—§é¢ = å‰©ä½™ä»·å€¼ / ä½¿ç”¨å¹´é™ï¼ˆé€’å‡ï¼‰
   - **é—®é¢˜**ï¼šç³»ç»Ÿå®ç°æ›´åƒæ˜¯"é€’å‡ç›´çº¿æ³•"ï¼Œè€Œä¸æ˜¯æ ‡å‡†çš„ç›´çº¿æ³•
   
   **æ­£ç¡®çš„ç›´çº¿æ³•å®ç°åº”è¯¥æ˜¯**ï¼š
   ```
   å¹´æŠ˜æ—§é¢ = åŸå§‹è´­ä¹°ä»·æ ¼ / ä½¿ç”¨å¹´é™ï¼ˆå›ºå®šå€¼ï¼Œæ¯å¹´ç›¸åŒï¼‰
   
   ç¬¬1å¹´ï¼š
     æœŸåˆä»·å€¼ï¼š$10,000
     æŠ˜æ—§é¢ï¼š$2,000ï¼ˆå›ºå®šï¼‰
     æœŸæœ«ä»·å€¼ï¼š$8,000
   
   ç¬¬2å¹´ï¼š
     æœŸåˆä»·å€¼ï¼š$8,000
     æŠ˜æ—§é¢ï¼š$2,000ï¼ˆå›ºå®šï¼Œä¸æ˜¯ $8,000/5ï¼‰
     æœŸæœ«ä»·å€¼ï¼š$6,000
   
   ç¬¬3å¹´ï¼š
     æœŸåˆä»·å€¼ï¼š$6,000
     æŠ˜æ—§é¢ï¼š$2,000ï¼ˆå›ºå®šï¼‰
     æœŸæœ«ä»·å€¼ï¼š$4,000
   
   ç¬¬4å¹´ï¼š
     æœŸåˆä»·å€¼ï¼š$4,000
     æŠ˜æ—§é¢ï¼š$2,000ï¼ˆå›ºå®šï¼‰
     æœŸæœ«ä»·å€¼ï¼š$2,000
   
   ç¬¬5å¹´ï¼š
     æœŸåˆä»·å€¼ï¼š$2,000
     æŠ˜æ—§é¢ï¼š$2,000ï¼ˆå›ºå®šï¼‰
     æœŸæœ«ä»·å€¼ï¼š$0ï¼ˆå®Œå…¨æŠ˜æ—§ï¼‰
   ```
   
   **é€‚ç”¨æ¡ä»¶**ï¼š
   - é€‚ç”¨äºæ‰€æœ‰ç”¨äºäº§ç”Ÿå¯è¯„ä¼°æ”¶å…¥çš„ä¸šåŠ¡èµ„äº§
   - èµ„äº§éœ€æœ‰ATOè§„å®šçš„æœ‰æ•ˆä½¿ç”¨å¹´é™ï¼ˆEffective Lifeï¼‰
   - é€‚ç”¨äºåœ¨æ•´ä¸ªä½¿ç”¨æœŸé—´æä¾›å‡åŒ€ç»æµåˆ©ç›Šçš„èµ„äº§
   - é€‚åˆéœ€è¦ç¨³å®šæŠ˜æ—§è´¹ç”¨çš„ä¼ä¸š
   
   **ä¼˜åŠ¿**ï¼š
   - æ¯å¹´æŠ˜æ—§é¢å›ºå®šï¼Œä¾¿äºè´¢åŠ¡è§„åˆ’å’Œé¢„ç®—
   - è®¡ç®—ç®€å•ï¼Œæ˜“äºç†è§£å’Œæ“ä½œ
   - é€‚ç”¨äºå¤§å¤šæ•°å›ºå®šèµ„äº§
   - åœ¨èµ„äº§ä½¿ç”¨å¹´é™ç»“æŸæ—¶å®Œå…¨æŠ˜æ—§åˆ°0ï¼ˆå¦‚æœæ®‹å€¼ä¸º0ï¼‰
   
   **é™åˆ¶**ï¼š
   - ä¸€æ—¦é€‰æ‹©ç›´çº¿æ³•ï¼Œå¿…é¡»åœ¨èµ„äº§æ•´ä¸ªä½¿ç”¨æœŸé—´ä¿æŒä¸€è‡´
   - ä¸èƒ½ä¸­é€”æ”¹ä¸ºé€’å‡ä½™é¢æ³•
   - éœ€è¦æ ¹æ®ATOçš„æœ‰æ•ˆä½¿ç”¨å¹´é™è¡¨ç¡®å®šä½¿ç”¨å¹´é™
   - å‰æœŸç¨åŠ¡æŠµæ‰£è¾ƒå°‘ï¼ˆç›¸æ¯”é€’å‡ä½™é¢æ³•ï¼‰
   
   **ä¸é€’å‡ä½™é¢æ³•çš„å¯¹æ¯”**ï¼š
   
   | é¡¹ç›® | ç›´çº¿æ³• | é€’å‡ä½™é¢æ³• |
   |------|--------|-----------|
   | å¹´æŠ˜æ—§é¢ | å›ºå®šï¼ˆæ¯å¹´ç›¸åŒï¼‰ | é€’å‡ï¼ˆå‰æœŸé«˜ï¼ŒåæœŸä½ï¼‰ |
   | å‰æœŸç¨åŠ¡æŠµæ‰£ | è¾ƒå°‘ | è¾ƒå¤š |
   | è®¡ç®—å¤æ‚åº¦ | ç®€å• | ä¸­ç­‰ |
   | å®Œå…¨æŠ˜æ—§æ—¶é—´ | ä½¿ç”¨å¹´é™ç»“æŸæ—¶ | ç†è®ºä¸Šä¸ä¼šå®Œå…¨æŠ˜æ—§ |
   | é€‚ç”¨èµ„äº§ | æä¾›å‡åŒ€ç»æµåˆ©ç›Šçš„èµ„äº§ | æŠ€æœ¯æ›´æ–°å¿«çš„èµ„äº§ |

**é‡è¦æ³¨æ„äº‹é¡¹**ï¼š
- èµ„äº§å¿…é¡»ç”¨äºäº§ç”Ÿå¯è¯„ä¼°æ”¶å…¥ï¼ˆassessable incomeï¼‰çš„ä¸šåŠ¡æ´»åŠ¨
- æŠ˜æ—§æ–¹æ³•ä¸€æ—¦é€‰æ‹©ï¼Œå¿…é¡»åœ¨èµ„äº§æ•´ä¸ªä½¿ç”¨æœŸé—´ä¿æŒä¸€è‡´
- éœ€è¦å‚è€ƒATOçš„"æœ‰æ•ˆä½¿ç”¨å¹´é™è¡¨"ï¼ˆEffective Lifeï¼‰æ¥ç¡®å®šæŠ˜æ—§å¹´é™
- æŸäº›èµ„äº§ï¼ˆå¦‚å»ºç­‘ç‰©ã€åœŸåœ°ï¼‰æœ‰ç‰¹æ®Šçš„æŠ˜æ—§è§„åˆ™
- æ”¿ç­–ä¼šéšæ—¶é—´å˜åŒ–ï¼Œå»ºè®®æŸ¥è¯¢ATOæœ€æ–°æŒ‡å—

## æŠ˜æ—§æ–¹æ³•å¼€å‘æ–¹æ¡ˆï¼ˆæœ€ç»ˆç¡®å®šï¼‰

### åº”è¯¥å¼€å‘çš„æŠ˜æ—§æ–¹æ³•

æ ¹æ®ATOæ”¿ç­–ï¼Œç³»ç»Ÿå°†å®ç°ä»¥ä¸‹æŠ˜æ—§æ–¹æ³•ï¼š

1. **ä¸€æ¬¡æ€§èµ„äº§æ‰£é™¤ï¼ˆinstant_write_offï¼‰**
   - é€‚ç”¨äºèµ„äº§ä»·å€¼ â‰¤ æ”¿ç­–é™é¢ï¼ˆå¦‚$20,000ï¼Œéœ€æŸ¥è¯¢æœ€æ–°æ”¿ç­–ï¼‰
   - è´­ä¹°å½“å¹´å…¨é¢æ‰£é™¤
   - åç»­å¹´åº¦æ— æŠ˜æ—§
   - **è®¡ç®—å…¬å¼**ï¼š`depreciation_amount = opening_value`ï¼ˆç¬¬ä¸€å¹´ï¼‰ï¼Œ`closing_value = 0`

2. **ç›´çº¿æ³•ï¼ˆstraight_lineï¼‰**
   - é€‚ç”¨äºæ‰€æœ‰èµ„äº§ä»·å€¼
   - **è®¡ç®—å…¬å¼**ï¼š`å¹´æŠ˜æ—§é¢ = åŸå§‹è´­ä¹°ä»·æ ¼ / ä½¿ç”¨å¹´é™`ï¼ˆå›ºå®šå€¼ï¼Œæ¯å¹´ç›¸åŒï¼‰
   - åœ¨ä½¿ç”¨å¹´é™ç»“æŸæ—¶å®Œå…¨æŠ˜æ—§åˆ°0
   - **æ³¨æ„**ï¼šå¿…é¡»ä¿å­˜åŸå§‹è´­ä¹°ä»·æ ¼ï¼Œæ¯å¹´ä½¿ç”¨å›ºå®šæŠ˜æ—§é¢

3. **æ ‡å‡†é€’å‡ä½™é¢æ³•ï¼ˆdiminishing_balance_standardï¼‰**
   - é€‚ç”¨äºèµ„äº§ä»·å€¼ > $1,000
   - **è®¡ç®—å…¬å¼**ï¼š`æŠ˜æ—§ç‡ = 200% / æœ‰æ•ˆä½¿ç”¨å¹´é™`ï¼Œ`å¹´æŠ˜æ—§é¢ = æœŸåˆä»·å€¼ Ã— æŠ˜æ—§ç‡`
   - éœ€è¦è¾“å…¥æœ‰æ•ˆä½¿ç”¨å¹´é™

4. **ä½ä»·å€¼èµ„äº§æ± ï¼ˆdiminishing_balance_low_value_poolï¼‰**
   - é€‚ç”¨äºèµ„äº§ä»·å€¼ â‰¤ $1,000
   - **è®¡ç®—å…¬å¼**ï¼š
     - ç¬¬ä¸€å¹´ï¼š`å¹´æŠ˜æ—§é¢ = æœŸåˆä»·å€¼ Ã— 37.5%`
     - åç»­å¹´åº¦ï¼š`å¹´æŠ˜æ—§é¢ = æœŸåˆä»·å€¼ Ã— 18.75%`
     - å½“ä½™é¢ â‰¤ $300 æ—¶ï¼š`å¹´æŠ˜æ—§é¢ = æœŸåˆä»·å€¼`ï¼ˆä¸€æ¬¡æ€§å…¨éƒ¨æ‰£é™¤ï¼‰

### ATOå…³äºæ›´æ”¹æŠ˜æ—§æ–¹æ³•çš„æ”¿ç­–

**âš ï¸ é‡è¦é™åˆ¶**ï¼š

æ ¹æ®ATOæ”¿ç­–ï¼š
- **ä¸€æ—¦é€‰æ‹©æŠ˜æ—§æ–¹æ³•ï¼Œå¿…é¡»åœ¨èµ„äº§æ•´ä¸ªä½¿ç”¨æœŸé—´ä¿æŒä¸€è‡´**
- **å¦‚æœèµ„äº§åœ¨ä¹‹å‰çš„è´¢å¹´å·²ç»éƒ¨åˆ†æŠ˜æ—§ï¼Œé€šå¸¸ä¸å…è®¸æ›´æ”¹æŠ˜æ—§æ–¹æ³•**
- æ›´æ”¹æŠ˜æ—§æ–¹æ³•å¯èƒ½éœ€è¦ATOæ‰¹å‡†ï¼Œå¹¶æ¶‰åŠå¤æ‚çš„ç¨åŠ¡å¤„ç†

**ç³»ç»Ÿè®¾è®¡å†³ç­–**ï¼š

ç³»ç»Ÿè®¾è®¡å…è®¸"è°ƒæ•´è®¾å¤‡æŠ˜æ—§æ–¹æ³•ç”¨äºä¸‹æ¬¡æŠ¥è¡¨"ï¼Œä½†æ·»åŠ ä¿æŠ¤æœºåˆ¶ï¼š

1. **å·²ç¡®è®¤çš„è®°å½•ï¼ˆis_committed = trueï¼‰**ï¼š
   - è¿™äº›è®°å½•å·²ç»ç”¨äºæŠ¥ç¨ï¼Œä¸èƒ½æ›´æ”¹
   - åç»­è´¢å¹´å¿…é¡»ä½¿ç”¨ç›¸åŒçš„æŠ˜æ—§æ–¹æ³•ï¼ˆATOè¦æ±‚ï¼‰
   - ç³»ç»Ÿåœ¨è®¡ç®—æ—¶ä¼šæ£€æŸ¥è®¾å¤‡æ˜¯å¦æœ‰å·²ç¡®è®¤çš„è®°å½•ï¼Œå¦‚æœæœ‰ï¼Œä½¿ç”¨ç›¸åŒçš„æŠ˜æ—§æ–¹æ³•

2. **æœªç¡®è®¤çš„è®°å½•ï¼ˆis_committed = falseï¼‰**ï¼š
   - ç³»ç»Ÿå…è®¸è°ƒæ•´æŠ˜æ—§æ–¹æ³•ï¼ˆçµæ´»æ€§ï¼‰
   - **ä½†éœ€è¦æ³¨æ„**ï¼šå¦‚æœè¯¥è®¾å¤‡åœ¨ä¹‹å‰çš„è´¢å¹´å·²ç»ç”¨æŸç§æ–¹æ³•æŠ¥è¿‡ç¨ï¼Œæ›´æ”¹æ–¹æ³•å¯èƒ½ä¸ç¬¦åˆATOè§„å®š
   - ç³»ç»Ÿä¼šåœ¨æ›´æ”¹æ—¶ç»™å‡ºè­¦å‘Š

3. **ä¿æŠ¤æœºåˆ¶**ï¼š
   - åœ¨è®¾å¤‡è¡¨ä¸­æ·»åŠ  `initial_depreciation_method` å­—æ®µï¼Œè®°å½•é¦–æ¬¡ä½¿ç”¨çš„æŠ˜æ—§æ–¹æ³•
   - å¦‚æœè®¾å¤‡å·²æœ‰å·²ç¡®è®¤çš„æŠ˜æ—§è®°å½•ï¼Œç³»ç»Ÿè‡ªåŠ¨ä½¿ç”¨ç›¸åŒçš„æŠ˜æ—§æ–¹æ³•ï¼ˆä¸å…è®¸æ›´æ”¹ï¼‰
   - å¦‚æœè®¾å¤‡æ²¡æœ‰å·²ç¡®è®¤çš„è®°å½•ï¼Œå…è®¸æ›´æ”¹æŠ˜æ—§æ–¹æ³•ï¼Œä½†ç»™å‡ºè­¦å‘Šæç¤º
   - å…è®¸ç”¨æˆ·æ‰‹åŠ¨è°ƒæ•´ï¼ˆä½†éœ€è‡ªè¡Œæ‰¿æ‹…ç¨åŠ¡åˆè§„è´£ä»»ï¼‰

### æŠ˜æ—§æ–¹æ³•é€‰æ‹©å»ºè®®

**èµ„äº§ä»·å€¼ â‰¤ $1,000**ï¼š
- å¯ä»¥é€‰æ‹©åŠ å…¥ä½ä»·å€¼èµ„äº§æ± ï¼ˆé€’å‡ä½™é¢æ³•ï¼Œç‰¹æ®Šè§„åˆ™ï¼‰
- æˆ–ä½¿ç”¨æ ‡å‡†é€’å‡ä½™é¢æ³•
- æˆ–ä½¿ç”¨ç›´çº¿æ³•

**èµ„äº§ä»·å€¼ > $1,000 ä¸” â‰¤ æ”¿ç­–é™é¢ï¼ˆå¦‚$20,000ï¼‰**ï¼š
- å¯ä»¥é€‰æ‹©ä¸€æ¬¡æ€§æ‰£é™¤ï¼ˆå¦‚æœç¬¦åˆæ¡ä»¶ï¼‰
- æˆ–ä½¿ç”¨æ ‡å‡†é€’å‡ä½™é¢æ³•
- æˆ–ä½¿ç”¨ç›´çº¿æ³•

**èµ„äº§ä»·å€¼ > æ”¿ç­–é™é¢**ï¼š
- ä½¿ç”¨æ ‡å‡†é€’å‡ä½™é¢æ³•
- æˆ–ä½¿ç”¨ç›´çº¿æ³•

## è¯¦ç»†è®¾è®¡æ–‡æ¡£

å®Œæ•´çš„è®¾å¤‡æŠ˜æ—§æŠ¥è¡¨ç³»ç»Ÿè®¾è®¡æ–‡æ¡£è¯·å‚è€ƒï¼š
- `xituan_agent/devGuide/equipment-depreciation-report-design.md`

è¯¥æ–‡æ¡£åŒ…å«ï¼š
- å®Œæ•´çš„APIè®¾è®¡
- å‰ç«¯CMSé¡µé¢è®¾è®¡
- è¯¦ç»†çš„æ‰§è¡Œæµç¨‹
- æŠ˜æ—§è®¡ç®—é€»è¾‘å®ç°
- å®æ–½æ­¥éª¤

#### 3.2 è®¡ç®—é€»è¾‘
**æ ¸å¿ƒè®¾è®¡ç†å¿µ**ï¼š
- **ä¸é¢„è®¡ç®—æœªæ¥**ï¼šåªè®¡ç®—å½“å‰è´¢å¹´ï¼Œä¸é¢„å…ˆè®¡ç®—æœªæ¥æ‰€æœ‰è´¢å¹´
- **æŒ‰è´¢å¹´ä¿å­˜**ï¼šæ¯ä¸ªè®¾å¤‡æ¯ä¸ªè´¢å¹´ä¸€æ¡è®°å½•ï¼ˆå”¯ä¸€çº¦æŸï¼šequipment_id + financial_yearï¼‰
- **è®¡ç®—ä¾æ®**ï¼šåŸºäºä¸Šä¸€ä¸ªè´¢å¹´è®°å½•çš„æœŸæœ«ä»·å€¼ï¼Œæˆ–è®¾å¤‡è´­ä¹°ä»·æ ¼
- **å¯é‡å¤ç”Ÿæˆ**ï¼šæœªç¡®è®¤çš„è®°å½•å¯ä»¥é‡æ–°è®¡ç®—è¦†ç›–
- **ç¡®è®¤åé”å®š**ï¼šå·²ç¡®è®¤ç”¨äºæŠ¥è¡¨çš„è®°å½•ä¸å¯ä¿®æ”¹

**æœŸåˆä»·å€¼ç¡®å®šé€»è¾‘**ï¼š
1. æŸ¥è¯¢ä¸Šä¸€ä¸ªè´¢å¹´çš„æŠ˜æ—§è®°å½•
2. å¦‚æœå­˜åœ¨ â†’ ä½¿ç”¨å…¶ `closing_value` ä½œä¸º `opening_value`
3. å¦‚æœä¸å­˜åœ¨ â†’ ä½¿ç”¨è®¾å¤‡çš„ `purchase_price` ä½œä¸º `opening_value`

**æŠ˜æ—§è®¡ç®—å…¬å¼**ï¼ˆç³»ç»Ÿå®ç°ï¼‰ï¼š

- **ç›´çº¿æ³•ï¼ˆPrime Costï¼‰**ï¼š
  ```
  depreciation_amount = opening_value / useful_life_years
  closing_value = opening_value - depreciation_amount
  ```
  - æ³¨æ„ï¼šATOå…¬å¼é€šå¸¸åŒ…å«æ®‹å€¼ï¼Œç³»ç»Ÿç®€åŒ–å¤„ç†ä¸º `(æˆæœ¬ - æ®‹å€¼) / å¹´é™`ï¼Œæ®‹å€¼é€šå¸¸ä¸º0

- **æ ‡å‡†é€’å‡ä½™é¢æ³•ï¼ˆdiminishing_balance_standardï¼‰**ï¼š
  ```
  æŠ˜æ—§ç‡ = 200% / æœ‰æ•ˆä½¿ç”¨å¹´é™
  depreciation_amount = opening_value Ã— (æŠ˜æ—§ç‡ / 100)
  closing_value = opening_value - depreciation_amount
  ```
  - éœ€è¦æä¾›æœ‰æ•ˆä½¿ç”¨å¹´é™ï¼ˆusefulLifeYearsï¼‰
  - é€‚ç”¨äºèµ„äº§ä»·å€¼ > $1,000 çš„æƒ…å†µ

- **ä½ä»·å€¼èµ„äº§æ± ï¼ˆdiminishing_balance_low_value_poolï¼‰**ï¼š
  ```
  å¦‚æœ opening_value <= 300:
    depreciation_amount = opening_valueï¼ˆå…¨éƒ¨æŠ˜æ—§ï¼‰
  else if æ˜¯ç¬¬ä¸€å¹´:
    depreciation_amount = opening_value Ã— 0.375ï¼ˆ37.5%ï¼‰
  else:
    depreciation_amount = opening_value Ã— 0.1875ï¼ˆ18.75%ï¼‰
  closing_value = opening_value - depreciation_amount
  ```
  - é€‚ç”¨äºèµ„äº§ä»·å€¼ â‰¤ $1,000 çš„æƒ…å†µ
  - ç¬¬ä¸€å¹´37.5%ï¼Œåç»­å¹´åº¦18.75%
  - å½“ä½™é¢ â‰¤ $300 æ—¶ä¸€æ¬¡æ€§æ‰£é™¤

- **ä¸€æ¬¡æ€§æ³¨é”€ï¼ˆInstant Asset Write-Offï¼‰**ï¼š
  ```
  depreciation_amount = opening_valueï¼ˆç¬¬ä¸€å¹´å…¨é¢æ‰£é™¤ï¼‰
  closing_value = 0
  ```
  - ä»…åœ¨ç¬¬ä¸€å¹´ä½¿ç”¨ï¼Œåç»­å¹´åº¦æ— æŠ˜æ—§

**æœŸæœ«ä»·å€¼è®¡ç®—**ï¼š`closing_value = opening_value - depreciation_amount`

#### 3.3 æŠ¥è¡¨ç”Ÿæˆæµç¨‹
1. **ç”ŸæˆæŠ¥è¡¨**ï¼š
   - ç”¨æˆ·é€‰æ‹©è´¢å¹´ï¼ˆå¦‚ï¼š2024-25ï¼‰
   - ç³»ç»Ÿè·å–æ‰€æœ‰è®¾å¤‡
   - å¯¹æ¯ä¸ªè®¾å¤‡ï¼š
     - æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯¥è´¢å¹´è®°å½•
     - å¦‚æœå­˜åœ¨ä¸” `is_committed = true` â†’ è·³è¿‡ï¼ˆå·²ç¡®è®¤ï¼Œä¸é‡æ–°è®¡ç®—ï¼‰
     - å¦‚æœå­˜åœ¨ä¸” `is_committed = false` â†’ é‡æ–°è®¡ç®—å¹¶æ›´æ–°
     - å¦‚æœä¸å­˜åœ¨ â†’ æ–°å»ºè®°å½•
   - æ ¹æ®è®¾å¤‡å½“å‰æŠ˜æ—§æ–¹æ³•è®¾ç½®è®¡ç®—
   - ä¿å­˜ `calculated_initial_data`ï¼ˆå®Œæ•´è®¡ç®—ä¿¡æ¯ï¼‰

2. **ç¡®è®¤æŠ¥è¡¨**ï¼š
   - ç”¨æˆ·ç¡®è®¤æŠ¥è¡¨åï¼Œæ‰¹é‡æ ‡è®°ç›¸å…³æŠ˜æ—§è®°å½•
   - `is_committed = true`
   - è®°å½•ç¡®è®¤æ—¶é—´ã€ç¡®è®¤äººã€å¤‡æ³¨
   - ç¡®è®¤åä¸å¯ä¿®æ”¹

3. **é‡æ–°ç”Ÿæˆ**ï¼š
   - å¯ä»¥å¤šæ¬¡è¿è¡ŒæŠ¥è¡¨ç”Ÿæˆé€»è¾‘
   - æœªç¡®è®¤çš„è®°å½•å¯ä»¥é‡æ–°è®¡ç®—è¦†ç›–
   - å·²ç¡®è®¤çš„è®°å½•ä¸é‡æ–°è®¡ç®—

#### 3.4 ç¼–è¾‘æ§åˆ¶
- **å·²ç¡®è®¤è®°å½•ï¼ˆis_committed = trueï¼‰**ï¼š
  - æ˜¾ç¤ºé”å®šæ ‡è¯† ğŸ”’
  - ç¦ç”¨ç¼–è¾‘åŠŸèƒ½
  - å¯ä»¥æŸ¥çœ‹ `calculated_initial_data`
- **æœªç¡®è®¤è®°å½•ï¼ˆis_committed = falseï¼‰**ï¼š
  - å…è®¸ç¼–è¾‘ï¼ˆæ‰‹åŠ¨è°ƒæ•´ï¼‰
  - å…è®¸é‡æ–°ç”Ÿæˆï¼ˆè¦†ç›–ç³»ç»Ÿè®¡ç®—å€¼ï¼‰
  - ç¼–è¾‘å `is_adjusted = true`

### 4. è®¾å¤‡ç®¡ç†
- è®¾å¤‡åˆ—è¡¨å’Œè¯¦æƒ…
- è®¾å¤‡ç¼–è¾‘ Modalï¼ˆåŒ…å«æŠ˜æ—§è®¾ç½®ï¼‰
- æŠ˜æ—§è®°å½•ç®¡ç†
- è‡ªåŠ¨è®¡ç®—æŠ˜æ—§

### 5. æŠ¥è¡¨ç”Ÿæˆ

#### 5.1 è®¾å¤‡æŠ˜æ—§æŠ¥è¡¨
**åŠŸèƒ½**ï¼šæŒ‰è´¢å¹´ç”Ÿæˆè®¾å¤‡æŠ˜æ—§æŠ¥è¡¨ï¼Œç”¨äºç¨åŠ¡ç”³æŠ¥

**ç”Ÿæˆæµç¨‹**ï¼š
1. ç”¨æˆ·é€‰æ‹©è´¢å¹´ï¼ˆå¦‚ï¼š2024-25ï¼‰
2. ç³»ç»Ÿè·å–æ‰€æœ‰è®¾å¤‡åˆ—è¡¨
3. å¯¹æ¯ä¸ªè®¾å¤‡è®¡ç®—è¯¥è´¢å¹´æŠ˜æ—§ï¼š
   - ç¡®å®šæœŸåˆä»·å€¼ï¼ˆæ¥è‡ªä¸Šä¸€å¹´è®°å½•æˆ–è®¾å¤‡è´­ä¹°ä»·æ ¼ï¼‰
   - æ ¹æ®è®¾å¤‡å½“å‰æŠ˜æ—§æ–¹æ³•è®¡ç®—
   - ä¿å­˜æˆ–æ›´æ–°æŠ˜æ—§è®°å½•
4. ç”ŸæˆæŠ¥è¡¨æ•°æ®ï¼ˆåŒ…å«æ‰€æœ‰è®¾å¤‡çš„æŠ˜æ—§æ˜ç»†ï¼‰
5. ç”¨æˆ·ç¡®è®¤æŠ¥è¡¨åï¼Œæ‰¹é‡æ ‡è®°ç›¸å…³æŠ˜æ—§è®°å½•ä¸ºå·²ç¡®è®¤

**æŠ¥è¡¨å†…å®¹**ï¼š
- è®¾å¤‡åç§°ã€ç±»åˆ«
- è´¢å¹´
- æŠ˜æ—§æ–¹æ³•
- æœŸåˆä»·å€¼
- æŠ˜æ—§é‡‘é¢
- æœŸæœ«ä»·å€¼
- ç¡®è®¤çŠ¶æ€

**ç¡®è®¤æœºåˆ¶**ï¼š
- æŠ¥è¡¨ç”Ÿæˆåï¼Œç”¨æˆ·å¯ä»¥ç¡®è®¤ä¿å­˜
- ç¡®è®¤åï¼ŒæŠ¥è¡¨ä¸­ä½¿ç”¨çš„æ‰€æœ‰æŠ˜æ—§è®°å½•è¢«æ ‡è®°ä¸º `is_committed = true`
- å·²ç¡®è®¤çš„è®°å½•ä¸å¯ä¿®æ”¹ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§
- å¯ä»¥å¤šæ¬¡ç”ŸæˆæŠ¥è¡¨ï¼Œä½†å·²ç¡®è®¤çš„è®°å½•ä¸ä¼šé‡æ–°è®¡ç®—

#### 5.2 å…¶ä»–æŠ¥è¡¨ï¼ˆå¾…å®ç°ï¼‰
- æ”¯å‡ºæ±‡æ€»æŠ¥è¡¨ï¼ˆæŒ‰ç±»å‹ã€æŒ‰ä¾›åº”å•†ã€æŒ‰æ—¥æœŸèŒƒå›´ï¼‰
- GSTæŠ¥è¡¨ï¼ˆå¯é€€ç¨çš„GSTæ±‡æ€»ï¼‰
- è´¢åŠ¡æŠ¥è¡¨ï¼ˆæŸç›Šè¡¨ã€èµ„äº§è´Ÿå€ºè¡¨ï¼‰

## è®¾å¤‡ç¼–è¾‘ Modal è®¾è®¡

### åŠŸèƒ½éœ€æ±‚
1. **åŸºæœ¬ä¿¡æ¯**
   - è®¾å¤‡åç§°
   - æè¿°
   - ç±»åˆ«
   - ä¾›åº”å•†

2. **é‡‡è´­ä¿¡æ¯**
   - è´­ä¹°æ—¥æœŸ
   - è´­ä¹°ä»·æ ¼ï¼ˆä¸å«GSTï¼‰
   - GSTé‡‘é¢
   - å…³è”çš„æ”¯å‡ºè®°å½•

3. **æŠ˜æ—§è®¾ç½®**
   - æŠ˜æ—§æ–¹æ³•é€‰æ‹©ï¼š
     - ä¸€æ¬¡æ€§èµ„äº§æ‰£é™¤ï¼ˆinstant_write_offï¼‰
     - ç›´çº¿æ³•ï¼ˆstraight_lineï¼‰
     - æ ‡å‡†é€’å‡ä½™é¢æ³•ï¼ˆdiminishing_balance_standardï¼Œ> $1,000ï¼‰
     - ä½ä»·å€¼èµ„äº§æ± ï¼ˆdiminishing_balance_low_value_poolï¼Œâ‰¤ $1,000ï¼‰
   - é¢„è®¡ä½¿ç”¨å¹´é™ï¼ˆç”¨äºç›´çº¿æ³•å’Œæ ‡å‡†é€’å‡ä½™é¢æ³•ï¼‰
   - æ˜¯å¦å·²å®Œå…¨æŠ˜æ—§

4. **æŠ˜æ—§è®°å½•**
   - æ˜¾ç¤ºå†å²æŠ˜æ—§è®°å½•ï¼ˆæŒ‰è´¢å¹´ï¼‰
   - æ˜¾ç¤ºç¡®è®¤çŠ¶æ€ï¼ˆå·²ç¡®è®¤/æœªç¡®è®¤ï¼‰
   - å·²ç¡®è®¤çš„è®°å½•æ˜¾ç¤ºé”å®šæ ‡è¯†ï¼Œä¸å¯ç¼–è¾‘
   - æœªç¡®è®¤çš„è®°å½•å¯ä»¥ç¼–è¾‘æˆ–é‡æ–°ç”Ÿæˆ
   - æŸ¥çœ‹è®¡ç®—åˆå§‹å€¼ï¼ˆcalculated_initial_dataï¼‰
   - å½“å‰è´¦é¢ä»·å€¼
   - ç´¯è®¡æŠ˜æ—§

5. **çŠ¶æ€ç®¡ç†**
   - è®¾å¤‡çŠ¶æ€ï¼ˆactive/disposed/written_offï¼‰
   - å¤„ç½®æ—¥æœŸå’Œå¤„ç½®ä»·å€¼ï¼ˆå¦‚é€‚ç”¨ï¼‰

## å®æ–½è®¡åˆ’

### é˜¶æ®µ1ï¼šåˆ›å»ºæ–°è¡¨ç»“æ„ âœ… å·²å®Œæˆ
1. âœ… åˆ›å»º `suppliers` è¡¨ï¼ˆé€šç”¨ä¾›åº”å•†è¡¨ï¼‰
2. âœ… åˆ›å»º `expenses` è¡¨ï¼ˆé€šç”¨æ”¯å‡ºè¡¨ï¼‰
3. âœ… åˆ›å»º `equipment` è¡¨ï¼ˆè®¾å¤‡è¡¨ï¼‰
4. âœ… åˆ›å»º `equipment_depreciation_records` è¡¨ï¼ˆè®¾å¤‡æŠ˜æ—§è®°å½•è¡¨ï¼‰

### é˜¶æ®µ2ï¼šæ•°æ®è¿ç§»ï¼ˆSQL è¿ç§»æ–‡ä»¶ï¼‰ âœ… å·²å®Œæˆ
**æ³¨æ„**ï¼šæœ¬é¡¹ç›®ä½¿ç”¨ SQL æ–‡ä»¶è¿›è¡Œæ•°æ®åº“è¿ç§»ï¼Œæ‰€æœ‰è¿ç§»éƒ½åœ¨ `xituan_backend/migrations/` ç›®å½•ä¸‹ã€‚

**å·²å®Œæˆçš„è¿ç§»æ–‡ä»¶**ï¼š
1. âœ… `1710000000193_migrate_raw_material_to_financial_tables.sql` - åŸºç¡€æ•°æ®è¿ç§»
2. âœ… `1710000000194_add_ocr_fields_to_expenses.sql` - æ·»åŠ OCRç›¸å…³å­—æ®µ
3. âœ… `1710000000195_migrate_ocr_and_items_to_expenses.sql` - è¿ç§»OCRæ•°æ®å’Œå•†å“é¡¹
4. âœ… `1710000000196_add_receipt_total_amount_to_expenses.sql` - æ·»åŠ æ”¶æ®æ€»ä»·å­—æ®µ
5. âœ… `1710000000197_migrate_receipt_total_amount_to_expenses.sql` - è¿ç§»æ”¶æ®æ€»ä»·æ•°æ®
6. âœ… `1710000000198_remove_description_from_expenses.sql` - ç§»é™¤descriptionå­—æ®µ
7. âœ… `1710000000199_fix_expenses_amounts_from_raw_material_receipts.sql` - ä¿®å¤é‡‘é¢æ•°æ®

**è¿ç§»å†…å®¹**ï¼š
- âœ… ä» `raw_material_suppliers` å¤åˆ¶æ•°æ®åˆ° `suppliers`ï¼ˆ`supplier_type = 'raw_material'`ï¼‰
- âœ… ä» `raw_material_receipts` å¤åˆ¶æ•°æ®åˆ° `expenses`ï¼ˆ`expense_type = 'raw_material'`ï¼‰
- âœ… è¿ç§»å­—æ®µæ˜ å°„ï¼š
  - `supplier_id` â†’ `supplier_id`
  - `supplier_name` â†’ `supplier_name`
  - `receipt_date` â†’ `expense_date`
  - `final_total_amount` â†’ `total_amount`ï¼ˆä¿®æ­£åï¼‰
  - `final_gst_amount` â†’ `gst_amount`ï¼ˆä¿®æ­£åï¼‰
  - `receipt_total_amount` â†’ `receipt_total_amount`
  - `receipt_image_path` â†’ `receipt_image_path`
  - `items` â†’ `items`ï¼ˆJSONBæ ¼å¼ï¼‰
  - `ocr_raw_data` â†’ `ocr_raw_data`ï¼ˆJSONBæ ¼å¼ï¼‰

### é˜¶æ®µ3ï¼šBackend æ›´æ–° âœ… å·²å®Œæˆ
1. âœ… åˆ›å»ºæ–°çš„ Domain å±‚ï¼š
   - `supplier` domainï¼ˆæ›¿ä»£ `raw-material-supplier`ï¼‰
   - `expense` domainï¼ˆæ›¿ä»£ `raw-material-receipt`ï¼‰
   - `equipment` domainï¼ˆæ–°å¢ï¼‰
   - `equipment-depreciation` domainï¼ˆæ–°å¢ï¼‰
2. âœ… æ›´æ–° Service å±‚ï¼š
   - ä½¿ç”¨æ–°è¡¨è¿›è¡Œ CRUD æ“ä½œ
   - å®ç° OCR è¯†åˆ«åŠŸèƒ½ï¼ˆ`uploadAndRecognize`, `reRecognize`, `reAnalyze`ï¼‰
   - å®ç°æ‰‹åŠ¨ä¸Šä¼ åŠŸèƒ½ï¼ˆ`uploadImageManually`ï¼‰
   - å®ç°ä¾›åº”å•†åŒ¹é…é€»è¾‘
   - å®ç°ç®€åŒ–çš„ GST è®¡ç®—é€»è¾‘
3. âœ… æ›´æ–° Controller å’Œ Routesï¼š
   - é€‚é…æ–°çš„æ•°æ®ç»“æ„
   - ä¿æŒ RESTful API è®¾è®¡
   - æ·»åŠ  OCR ç›¸å…³ API ç«¯ç‚¹

### é˜¶æ®µ4ï¼šCMS å‰ç«¯æ›´æ–° âœ… å·²å®Œæˆ
1. âœ… æ›´æ–°ä¾›åº”å•†ç®¡ç†é¡µé¢ï¼š
   - é€‚é… `suppliers` è¡¨ç»“æ„
   - æ·»åŠ  `supplier_type` é€‰æ‹©
   - æ›´æ–°è¡¨å•å­—æ®µ
2. âœ… æ›´æ–°æ”¯å‡ºç®¡ç†é¡µé¢ï¼š
   - é€‚é… `expenses` è¡¨ç»“æ„
   - æ·»åŠ  `expense_type` é€‰æ‹©
   - æ›´æ–°åˆ—è¡¨å’Œç¼–è¾‘åŠŸèƒ½
   - **ä¿ç•™å¹¶å¢å¼ºåŸææ–™æ”¶æ®çš„ OCR åŠŸèƒ½**ï¼š
     - è‡ªåŠ¨è¯†åˆ«æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
     - æ‰‹åŠ¨è¾“å…¥æ¨¡å¼
     - é‡æ–°è¯†åˆ«åŠŸèƒ½
     - é‡æ–°åˆ†æåŠŸèƒ½
     - å•†å“é¡¹ç®¡ç†ï¼ˆOCRè¯†åˆ«çš„ä¸å¯åˆ é™¤ï¼Œæ‰‹åŠ¨æ·»åŠ çš„å¯åˆ é™¤ï¼‰
   - **URL å‚æ•°è¿‡æ»¤æ”¯æŒ**ï¼š
     - æ”¯æŒé€šè¿‡ URL å‚æ•°ç›´æ¥è®¿é—®è¿‡æ»¤åçš„åˆ—è¡¨ï¼ˆå¦‚ï¼š`/expenses?supplierId=xxx&expenseType=raw_material`ï¼‰
     - è¿‡æ»¤æ¡ä»¶å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–° URLï¼Œä¾¿äºåˆ†äº«å’Œä¹¦ç­¾
     - æ”¯æŒæ‰€æœ‰è¿‡æ»¤æ¡ä»¶ï¼š`supplierId`ã€`expenseType`ã€`businessType`ã€`startDate`/`endDate`ã€`totalAmountMin`ã€`totalAmountMax`ã€`receiptTotalAmount`
3. âœ… åˆ›å»ºè®¾å¤‡ç®¡ç†é¡µé¢ï¼š
   - è®¾å¤‡åˆ—è¡¨
   - è®¾å¤‡ç¼–è¾‘ Modalï¼ˆåŒ…å«æŠ˜æ—§è®¾ç½®å’Œè®°å½•ï¼‰
   - æŠ˜æ—§è®°å½•ç®¡ç†
4. â³ æŠ¥è¡¨åŠŸèƒ½ï¼ˆéƒ¨åˆ†å®ç°ï¼‰ï¼š
   - âœ… è®¾å¤‡æŠ˜æ—§æŠ¥è¡¨ï¼ˆç”Ÿæˆå’Œç¡®è®¤åŠŸèƒ½ï¼‰
   - â³ æ”¯å‡ºæ±‡æ€»æŠ¥è¡¨
   - â³ GST æŠ¥è¡¨
   - â³ è´¢åŠ¡æŠ¥è¡¨ï¼ˆæŸç›Šè¡¨ã€èµ„äº§è´Ÿå€ºè¡¨ï¼‰

### é˜¶æ®µ5ï¼šæ¸…ç† âœ… å·²å®Œæˆ
1. âœ… å·²åˆ é™¤ `raw_material_suppliers` å’Œ `raw_material_receipts` è¡¨
2. âœ… å·²åˆ é™¤ç›¸å…³çš„åç«¯ä»£ç æ–‡ä»¶ï¼ˆentity, repository, service, controller, routesï¼‰
3. âœ… å·²åˆ é™¤ç›¸å…³çš„ CMS å‰ç«¯ä»£ç æ–‡ä»¶ï¼ˆAPI, é¡µé¢ç»„ä»¶, ç¼–è¾‘ Modalï¼‰
4. âœ… å·²åˆ›å»º SQL è¿ç§»æ–‡ä»¶ `1710000000200_drop_raw_material_tables.sql` ç”¨äºåˆ é™¤æ—§è¡¨

## æ•°æ®è¿ç§» SQL æ–‡ä»¶

**è¯´æ˜**ï¼šæœ¬é¡¹ç›®ä½¿ç”¨ SQL æ–‡ä»¶è¿›è¡Œæ•°æ®åº“è¿ç§»ï¼Œæ‰€æœ‰è¿ç§»æ–‡ä»¶éƒ½åœ¨ `xituan_backend/migrations/` ç›®å½•ä¸‹ï¼Œé€šè¿‡ TypeORM çš„è¿ç§»ç³»ç»Ÿæ‰§è¡Œã€‚

**å·²å®Œæˆçš„è¿ç§»æ–‡ä»¶åˆ—è¡¨**ï¼š
1. `1710000000193_migrate_raw_material_to_financial_tables.sql` - åŸºç¡€æ•°æ®è¿ç§»ï¼ˆä¾›åº”å•†å’Œæ”¯å‡ºï¼‰
2. `1710000000194_add_ocr_fields_to_expenses.sql` - æ·»åŠ OCRç›¸å…³å­—æ®µï¼ˆitems, ocr_raw_data, ocr_raw_data_tempï¼‰
3. `1710000000195_migrate_ocr_and_items_to_expenses.sql` - è¿ç§»OCRæ•°æ®å’Œå•†å“é¡¹
4. `1710000000196_add_receipt_total_amount_to_expenses.sql` - æ·»åŠ æ”¶æ®æ€»ä»·å­—æ®µ
5. `1710000000197_migrate_receipt_total_amount_to_expenses.sql` - è¿ç§»æ”¶æ®æ€»ä»·æ•°æ®
6. `1710000000198_remove_description_from_expenses.sql` - ç§»é™¤descriptionå­—æ®µ
7. `1710000000199_fix_expenses_amounts_from_raw_material_receipts.sql` - ä¿®å¤é‡‘é¢æ•°æ®ï¼ˆä½¿ç”¨final_total_amountå’Œfinal_gst_amountï¼‰
8. `1710000000200_drop_raw_material_tables.sql` - åˆ é™¤æ—§çš„ raw_material ç›¸å…³è¡¨ï¼ˆæ¸…ç†é˜¶æ®µï¼‰

**å…³é”®è¿ç§»é€»è¾‘**ï¼š
- ä¾›åº”å•†æ•°æ®ï¼šä» `raw_material_suppliers` è¿ç§»åˆ° `suppliers`ï¼Œè®¾ç½® `supplier_type = 'raw_material'`
- æ”¯å‡ºæ•°æ®ï¼šä» `raw_material_receipts` è¿ç§»åˆ° `expenses`ï¼Œè®¾ç½® `expense_type = 'raw_material'`
- é‡‘é¢è®¡ç®—ï¼šä½¿ç”¨ `final_total_amount` å’Œ `final_gst_amount`ï¼ˆè€Œé `receipt_total_amount`ï¼‰
- OCRæ•°æ®ï¼šè¿ç§» `ocr_raw_data` å’Œ `items`ï¼ˆJSONBæ ¼å¼ï¼‰
- æ”¶æ®æ€»ä»·ï¼šå•ç‹¬è¿ç§» `receipt_total_amount` å­—æ®µï¼ˆç”¨äºè¿‡æ»¤å’ŒæŸ¥è¯¢ï¼‰

## è®¾å¤‡æŠ˜æ—§è®¾è®¡ä¼˜åŠ¿

1. **çµæ´»è®¡ç®—**ï¼šä¸é¢„è®¡ç®—æœªæ¥ï¼ŒæŒ‰éœ€è®¡ç®—å½“å‰è´¢å¹´ï¼Œå¯éšæ—¶è°ƒæ•´è®¾å¤‡æŠ˜æ—§æ–¹æ³•
2. **å¯é‡å¤ç”Ÿæˆ**ï¼šå¯ä»¥å¤šæ¬¡è¿è¡ŒæŠ¥è¡¨ç”Ÿæˆé€»è¾‘ï¼Œæœªç¡®è®¤è®°å½•å¯é‡æ–°è®¡ç®—è¦†ç›–
3. **æ•°æ®ä¸€è‡´æ€§**ï¼šåŸºäºæœ€æ–°è®¾å¤‡è®¾ç½®å’Œä¸Šä¸€å¹´è®°å½•è®¡ç®—ï¼Œä¿è¯æ•°æ®å‡†ç¡®
4. **å¯è¿½æº¯æ€§**ï¼šä¿å­˜å®Œæ•´è®¡ç®—ä¿¡æ¯ï¼ˆcalculated_initial_dataï¼‰ï¼Œä¾¿äºå®¡è®¡å’ŒéªŒè¯
5. **å®‰å…¨é”å®š**ï¼šå·²ç¡®è®¤ç”¨äºæŠ¥è¡¨çš„è®°å½•ä¸å¯ä¿®æ”¹ï¼Œä¿è¯æ•°æ®å®Œæ•´æ€§
6. **çµæ´»è°ƒæ•´**ï¼šæœªç¡®è®¤çš„è®°å½•å¯ä»¥æ‰‹åŠ¨è°ƒæ•´æˆ–é‡æ–°ç”Ÿæˆï¼Œé€‚åº”ä¸šåŠ¡å˜åŒ–

## ç³»ç»Ÿæ•´ä½“ä¼˜åŠ¿

1. **ç»Ÿä¸€ç®¡ç†**ï¼šæ‰€æœ‰æ”¯å‡ºåœ¨ä¸€ä¸ªè¡¨ä¸­ï¼Œä¾¿äºæŸ¥è¯¢å’ŒæŠ¥è¡¨
2. **çµæ´»æ‰©å±•**ï¼šé€šè¿‡expense_typeå’Œsupplier_typeè½»æ¾æ·»åŠ æ–°ç±»å‹
3. **ä¸“ä¸šåˆè§„**ï¼šæ”¯æŒGSTç®¡ç†ã€æŠ˜æ—§è®¡ç®—ã€è´¢åŠ¡æŠ¥è¡¨
4. **ç²¾ç®€é«˜æ•ˆ**ï¼šæ ¸å¿ƒè¡¨åªæœ‰4ä¸ªï¼Œç»“æ„æ¸…æ™°
5. **å‘åå…¼å®¹**ï¼šå¯ä»¥ä¿ç•™ç°æœ‰raw_materialç›¸å…³è¡¨ï¼Œé€æ­¥è¿ç§»

## çƒ˜ç„™ä¸šåŠ¡è´¢åŠ¡ç®¡ç†ç³»ç»Ÿå®Œæ•´è€ƒè™‘äº‹é¡¹

### å·²å®ç°åŠŸèƒ½ âœ…
1. **æ”¯å‡ºç®¡ç†** - æ‰€æœ‰ç±»å‹çš„æ”¯å‡ºè®°å½•ï¼ˆåŸææ–™ã€æœåŠ¡ã€è®¾å¤‡ã€ç§Ÿé‡‘ã€æ°´ç”µç­‰ï¼‰
2. **è®¾å¤‡æŠ˜æ—§** - è®¾å¤‡èµ„äº§ç®¡ç†å’ŒæŠ˜æ—§è®¡ç®—ï¼ˆæ”¯æŒå¤šç§æŠ˜æ—§æ–¹æ³•ï¼‰
3. **ä¾›åº”å•†ç®¡ç†** - ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ç±»å‹çš„ä¾›åº”å•†
4. **GSTç®¡ç†** - è‡ªåŠ¨è®¡ç®—GSTï¼Œæ”¯æŒå«ç¨/ä¸å«ç¨ä»·æ ¼

### éœ€è¦è¡¥å……çš„åŠŸèƒ½ â³

#### 1. æ”¶å…¥ç®¡ç†ï¼ˆRevenue Managementï¼‰
**ç°çŠ¶**ï¼šç³»ç»Ÿå·²æœ‰è®¢å•ç³»ç»Ÿï¼ˆ`orders`è¡¨ï¼‰ï¼Œä½†æœªä¸è´¢åŠ¡ç³»ç»Ÿé›†æˆ

**éœ€è¦å®ç°**ï¼š
- **æ”¶å…¥è®°å½•è¡¨** (`revenues`)ï¼š
  - å…³è”è®¢å•ç³»ç»Ÿï¼Œè‡ªåŠ¨è®°å½•é”€å”®æ”¶å…¥
  - æ”¯æŒå¤šç§æ”¶å…¥ç±»å‹ï¼š`product_sales`ï¼ˆäº§å“é”€å”®ï¼‰ã€`service_income`ï¼ˆæœåŠ¡æ”¶å…¥ï¼‰ã€`other_income`ï¼ˆå…¶ä»–æ”¶å…¥ï¼‰
  - è®°å½•æ”¶å…¥æ—¥æœŸã€é‡‘é¢ã€GSTã€å®¢æˆ·ä¿¡æ¯
  - æ”¯æŒç°é‡‘æ”¶å…¥ã€åº”æ”¶è´¦æ¬¾ï¼ˆè´¦æœŸé”€å”®ï¼‰
- **æ”¶å…¥ä¸è®¢å•é›†æˆ**ï¼š
  - è®¢å•æ”¯ä»˜æˆåŠŸåè‡ªåŠ¨åˆ›å»ºæ”¶å…¥è®°å½•
  - æ”¯æŒè®¢å•é€€æ¬¾æ—¶è‡ªåŠ¨è°ƒæ•´æ”¶å…¥è®°å½•
  - åŒºåˆ†å·²æ”¶æ¬¾å’Œæœªæ”¶æ¬¾ï¼ˆåº”æ”¶è´¦æ¬¾ï¼‰

**è¡¨ç»“æ„å»ºè®®**ï¼š
```sql
CREATE TABLE revenues (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    order_id UUID REFERENCES orders(id) ON DELETE SET NULL,  -- å…³è”è®¢å•ï¼ˆå¯é€‰ï¼‰
    revenue_date DATE NOT NULL,
    revenue_type VARCHAR(50) NOT NULL,  -- 'product_sales', 'service_income', 'other_income'
    total_amount DECIMAL(10,2) NOT NULL,  -- æ€»é‡‘é¢ï¼ˆå«GSTï¼‰
    gst_amount DECIMAL(10,2) DEFAULT 0,  -- GSTé‡‘é¢
    net_amount DECIMAL(10,2) NOT NULL,  -- å‡€é‡‘é¢ï¼ˆä¸å«GSTï¼‰
    payment_status VARCHAR(20) DEFAULT 'paid',  -- 'paid', 'pending'ï¼ˆåº”æ”¶è´¦æ¬¾ï¼‰
    customer_name VARCHAR(255),  -- å®¢æˆ·åç§°
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);
```

#### 2. åŸææ–™åº“å­˜ç®¡ç†ï¼ˆRaw Material Inventoryï¼‰
**ç°çŠ¶**ï¼šç³»ç»Ÿæœ‰åŸææ–™æ”¯å‡ºè®°å½•ï¼Œä½†æ²¡æœ‰åº“å­˜è·Ÿè¸ª

**éœ€è¦å®ç°**ï¼š
- **åŸææ–™åº“å­˜è¡¨** (`raw_material_inventory`)ï¼š
  - è®°å½•æ¯ç§åŸææ–™çš„å½“å‰åº“å­˜æ•°é‡
  - æ”¯æŒå•ä½ç®¡ç†ï¼ˆkgã€Lã€ä¸ªç­‰ï¼‰
  - æœ€ä½åº“å­˜è­¦æˆ’çº¿
  - åº“å­˜æˆæœ¬è®¡ç®—ï¼ˆåŠ æƒå¹³å‡æ³•æˆ–å…ˆè¿›å…ˆå‡ºæ³•ï¼‰
- **åº“å­˜å˜åŠ¨è®°å½•** (`raw_material_inventory_transactions`)ï¼š
  - è®°å½•æ¯æ¬¡åº“å­˜å˜åŠ¨ï¼ˆé‡‡è´­å…¥åº“ã€ç”Ÿäº§å‡ºåº“ã€æŸè€—ç­‰ï¼‰
  - å…³è”æ”¯å‡ºè®°å½•ï¼ˆé‡‡è´­æ—¶ï¼‰
  - å…³è”ç”Ÿäº§è®°å½•ï¼ˆç”Ÿäº§å‡ºåº“æ—¶ï¼‰
- **åº“å­˜ä¸æ”¯å‡ºé›†æˆ**ï¼š
  - åŸææ–™æ”¯å‡ºæ—¶è‡ªåŠ¨å¢åŠ åº“å­˜
  - ç”Ÿäº§æ—¶è‡ªåŠ¨å‡å°‘åº“å­˜
  - æ”¯æŒåº“å­˜ç›˜ç‚¹è°ƒæ•´

**è¡¨ç»“æ„å»ºè®®**ï¼š
```sql
CREATE TABLE raw_material_inventory (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL UNIQUE,  -- åŸææ–™åç§°
    unit VARCHAR(20) NOT NULL,  -- å•ä½ï¼ˆkg, L, ä¸ªç­‰ï¼‰
    current_quantity DECIMAL(10,3) DEFAULT 0,  -- å½“å‰åº“å­˜æ•°é‡
    average_cost DECIMAL(10,2) DEFAULT 0,  -- åŠ æƒå¹³å‡æˆæœ¬
    min_stock_level DECIMAL(10,3) DEFAULT 0,  -- æœ€ä½åº“å­˜è­¦æˆ’çº¿
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE raw_material_inventory_transactions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    raw_material_id UUID REFERENCES raw_material_inventory(id) ON DELETE CASCADE,
    expense_id UUID REFERENCES expenses(id) ON DELETE SET NULL,  -- å…³è”æ”¯å‡ºï¼ˆé‡‡è´­æ—¶ï¼‰
    transaction_type VARCHAR(50) NOT NULL,  -- 'purchase', 'production', 'adjustment', 'loss'
    quantity DECIMAL(10,3) NOT NULL,  -- å˜åŠ¨æ•°é‡ï¼ˆæ­£æ•°=å…¥åº“ï¼Œè´Ÿæ•°=å‡ºåº“ï¼‰
    unit_cost DECIMAL(10,2),  -- å•ä½æˆæœ¬
    total_cost DECIMAL(10,2),  -- æ€»æˆæœ¬
    before_quantity DECIMAL(10,3) NOT NULL,  -- å˜åŠ¨å‰æ•°é‡
    after_quantity DECIMAL(10,3) NOT NULL,  -- å˜åŠ¨åæ•°é‡
    reference_id VARCHAR(100),  -- å…³è”ä¸šåŠ¡IDï¼ˆå¦‚ç”Ÿäº§è®¢å•IDï¼‰
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);
```

#### 3. äº§å“æˆæœ¬æ ¸ç®—ï¼ˆProduct Costingï¼‰
**ç°çŠ¶**ï¼šç³»ç»Ÿæœ‰äº§å“ä»·æ ¼ï¼Œä½†æ²¡æœ‰æˆæœ¬æ ¸ç®—

**éœ€è¦å®ç°**ï¼š
- **äº§å“æˆæœ¬è¡¨** (`product_costs`)ï¼š
  - è®°å½•æ¯ä¸ªäº§å“çš„æ ‡å‡†æˆæœ¬
  - åŒ…å«ï¼šåŸææ–™æˆæœ¬ã€äººå·¥æˆæœ¬ã€è®¾å¤‡æŠ˜æ—§åˆ†æ‘Šã€å…¶ä»–é—´æ¥æˆæœ¬
  - æ”¯æŒæˆæœ¬ç‰ˆæœ¬ç®¡ç†ï¼ˆä¸åŒæ—¶æœŸå¯èƒ½æœ‰ä¸åŒæˆæœ¬ï¼‰
- **æˆæœ¬è®¡ç®—é€»è¾‘**ï¼š
  - **åŸææ–™æˆæœ¬**ï¼šæ ¹æ®äº§å“é…æ–¹ï¼ˆBOMï¼‰å’ŒåŸææ–™åº“å­˜æˆæœ¬è®¡ç®—
  - **äººå·¥æˆæœ¬**ï¼šæ ¹æ®ç”Ÿäº§æ—¶é—´ Ã— äººå·¥è´¹ç‡
  - **è®¾å¤‡æŠ˜æ—§åˆ†æ‘Š**ï¼šæ ¹æ®è®¾å¤‡ä½¿ç”¨æ—¶é—´æˆ–äº§é‡åˆ†æ‘ŠæŠ˜æ—§è´¹ç”¨
  - **é—´æ¥æˆæœ¬åˆ†æ‘Š**ï¼šç§Ÿé‡‘ã€æ°´ç”µç­‰æŒ‰æ¯”ä¾‹åˆ†æ‘Š
- **äº§å“é…æ–¹ç®¡ç†** (`product_recipes` / `bom`)ï¼š
  - è®°å½•æ¯ä¸ªäº§å“éœ€è¦çš„åŸææ–™å’Œæ•°é‡
  - æ”¯æŒå¤šç‰ˆæœ¬é…æ–¹

**è¡¨ç»“æ„å»ºè®®**ï¼š
```sql
CREATE TABLE product_recipes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    product_id UUID NOT NULL,  -- å…³è”äº§å“
    version INTEGER DEFAULT 1,  -- é…æ–¹ç‰ˆæœ¬
    is_active BOOLEAN DEFAULT true,  -- æ˜¯å¦å½“å‰ä½¿ç”¨ç‰ˆæœ¬
    ingredients JSONB NOT NULL,  -- åŸææ–™æ¸…å• [{raw_material_id, quantity, unit}]
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE product_costs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    product_id UUID NOT NULL,
    cost_version INTEGER DEFAULT 1,  -- æˆæœ¬ç‰ˆæœ¬
    calculation_date DATE NOT NULL,  -- è®¡ç®—æ—¥æœŸ
    raw_material_cost DECIMAL(10,2) DEFAULT 0,  -- åŸææ–™æˆæœ¬
    labor_cost DECIMAL(10,2) DEFAULT 0,  -- äººå·¥æˆæœ¬
    depreciation_cost DECIMAL(10,2) DEFAULT 0,  -- è®¾å¤‡æŠ˜æ—§åˆ†æ‘Š
    indirect_cost DECIMAL(10,2) DEFAULT 0,  -- é—´æ¥æˆæœ¬åˆ†æ‘Š
    total_cost DECIMAL(10,2) NOT NULL,  -- æ€»æˆæœ¬
    calculation_details JSONB,  -- è¯¦ç»†è®¡ç®—è¿‡ç¨‹ï¼ˆç”¨äºè¿½æº¯ï¼‰
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);
```

#### 4. åº”æ”¶è´¦æ¬¾ç®¡ç†ï¼ˆAccounts Receivableï¼‰
**éœ€è¦å®ç°**ï¼š
- **åº”æ”¶è´¦æ¬¾è¡¨** (`accounts_receivable`)ï¼š
  - è®°å½•æœªæ”¶æ¬¾çš„é”€å”®è®¢å•
  - å…³è”æ”¶å…¥è®°å½•å’Œè®¢å•
  - è®°å½•è´¦æœŸã€åˆ°æœŸæ—¥ã€æ”¶æ¬¾çŠ¶æ€
  - æ”¯æŒéƒ¨åˆ†æ”¶æ¬¾
- **æ”¶æ¬¾è®°å½•** (`receipts`)ï¼š
  - è®°å½•æ¯æ¬¡æ”¶æ¬¾
  - å…³è”åº”æ”¶è´¦æ¬¾
  - æ”¯æŒå¤šç§æ”¶æ¬¾æ–¹å¼

#### 5. åº”ä»˜è´¦æ¬¾ç®¡ç†ï¼ˆAccounts Payableï¼‰
**éœ€è¦å®ç°**ï¼š
- **åº”ä»˜è´¦æ¬¾è¡¨** (`accounts_payable`)ï¼š
  - è®°å½•æœªä»˜æ¬¾çš„æ”¯å‡ºï¼ˆè´¦æœŸé‡‡è´­ï¼‰
  - å…³è”æ”¯å‡ºè®°å½•
  - è®°å½•è´¦æœŸã€åˆ°æœŸæ—¥ã€ä»˜æ¬¾çŠ¶æ€
  - æ”¯æŒéƒ¨åˆ†ä»˜æ¬¾
- **ä»˜æ¬¾è®°å½•** (`payments`)ï¼š
  - è®°å½•æ¯æ¬¡ä»˜æ¬¾
  - å…³è”åº”ä»˜è´¦æ¬¾
  - æ”¯æŒå¤šç§ä»˜æ¬¾æ–¹å¼

#### 6. ç°é‡‘æµç®¡ç†ï¼ˆCash Flow Managementï¼‰
**éœ€è¦å®ç°**ï¼š
- **ç°é‡‘æµé¢„æµ‹**ï¼š
  - åŸºäºåº”æ”¶è´¦æ¬¾å’Œåº”ä»˜è´¦æ¬¾é¢„æµ‹æœªæ¥ç°é‡‘æµ
  - æ”¯æŒæŒ‰æ—¥/å‘¨/æœˆæŸ¥çœ‹ç°é‡‘æµé¢„æµ‹
- **ç°é‡‘æµæŠ¥è¡¨**ï¼š
  - å®é™…ç°é‡‘æµ vs é¢„æµ‹ç°é‡‘æµå¯¹æ¯”
  - ç°é‡‘æµè¶‹åŠ¿åˆ†æ

#### 7. åˆ©æ¶¦åˆ†æï¼ˆProfitability Analysisï¼‰
**éœ€è¦å®ç°**ï¼š
- **æ¯›åˆ©ç‡åˆ†æ**ï¼š
  - äº§å“æ¯›åˆ©ç‡ = (é”€å”®ä»·æ ¼ - äº§å“æˆæœ¬) / é”€å”®ä»·æ ¼
  - æŒ‰äº§å“ã€æŒ‰ç±»åˆ«ã€æŒ‰æ—¶é—´æ®µåˆ†æ
- **å‡€åˆ©ç‡åˆ†æ**ï¼š
  - å‡€åˆ©ç‡ = (æ€»æ”¶å…¥ - æ€»æˆæœ¬ - æ€»æ”¯å‡º) / æ€»æ”¶å…¥
  - æ”¯æŒæŒ‰æ—¶é—´æ®µã€æŒ‰ä¸šåŠ¡ç±»å‹åˆ†æ
- **æˆæœ¬ç»“æ„åˆ†æ**ï¼š
  - åŸææ–™æˆæœ¬å æ¯”
  - äººå·¥æˆæœ¬å æ¯”
  - è®¾å¤‡æŠ˜æ—§å æ¯”
  - å…¶ä»–æˆæœ¬å æ¯”

#### 8. è´¢åŠ¡æŠ¥è¡¨ï¼ˆFinancial Reportsï¼‰
**éœ€è¦å®ç°**ï¼š
- **æŸç›Šè¡¨ï¼ˆProfit & Loss Statementï¼‰**ï¼š
  - æ”¶å…¥ï¼šäº§å“é”€å”®ã€æœåŠ¡æ”¶å…¥ã€å…¶ä»–æ”¶å…¥
  - æˆæœ¬ï¼šåŸææ–™æˆæœ¬ã€äººå·¥æˆæœ¬ã€è®¾å¤‡æŠ˜æ—§
  - æ”¯å‡ºï¼šç§Ÿé‡‘ã€æ°´ç”µã€è¥é”€ã€ä¸“ä¸šæœåŠ¡ç­‰
  - åˆ©æ¶¦ï¼šæ¯›åˆ©æ¶¦ã€å‡€åˆ©æ¶¦
- **èµ„äº§è´Ÿå€ºè¡¨ï¼ˆBalance Sheetï¼‰**ï¼š
  - èµ„äº§ï¼šç°é‡‘ã€åº”æ”¶è´¦æ¬¾ã€åº“å­˜ã€è®¾å¤‡ï¼ˆå‡€å€¼ï¼‰
  - è´Ÿå€ºï¼šåº”ä»˜è´¦æ¬¾ã€è´·æ¬¾ç­‰
  - æ‰€æœ‰è€…æƒç›Š
- **ç°é‡‘æµé‡è¡¨ï¼ˆCash Flow Statementï¼‰**ï¼š
  - ç»è¥æ´»åŠ¨ç°é‡‘æµ
  - æŠ•èµ„æ´»åŠ¨ç°é‡‘æµ
  - ç­¹èµ„æ´»åŠ¨ç°é‡‘æµ

#### 9. ç¨åŠ¡ç®¡ç†å¢å¼ºï¼ˆEnhanced Tax Managementï¼‰
**éœ€è¦å®ç°**ï¼š
- **GSTæŠ¥è¡¨**ï¼š
  - å¯é€€ç¨çš„GSTæ±‡æ€»ï¼ˆé‡‡è´­æ”¯å‡ºä¸­çš„GSTï¼‰
  - åº”ç¼´GSTæ±‡æ€»ï¼ˆé”€å”®æ”¶å…¥ä¸­çš„GSTï¼‰
  - GSTå‡€é¢è®¡ç®—
- **æ‰€å¾—ç¨è®¡ç®—**ï¼š
  - åŸºäºåˆ©æ¶¦è®¡ç®—åº”çº³ç¨æ‰€å¾—é¢
  - æ”¯æŒç¨åŠ¡æŠµæ‰£é¡¹ç®¡ç†
  - æŠ˜æ—§ç¨åŠ¡æŠµæ‰£æ±‡æ€»

#### 10. é¢„ç®—ç®¡ç†ï¼ˆBudget Managementï¼‰
**éœ€è¦å®ç°**ï¼š
- **é¢„ç®—åˆ¶å®š**ï¼š
  - æŒ‰æ”¯å‡ºç±»å‹åˆ¶å®šæœˆåº¦/å¹´åº¦é¢„ç®—
  - æŒ‰æ”¶å…¥ç±»å‹åˆ¶å®šæ”¶å…¥ç›®æ ‡
- **é¢„ç®—æ‰§è¡Œåˆ†æ**ï¼š
  - å®é™…æ”¯å‡º vs é¢„ç®—å¯¹æ¯”
  - å®é™…æ”¶å…¥ vs ç›®æ ‡å¯¹æ¯”
  - é¢„ç®—åå·®åˆ†æ

### å®æ–½ä¼˜å…ˆçº§å»ºè®®

**é«˜ä¼˜å…ˆçº§ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰**ï¼š
1. âœ… æ”¯å‡ºç®¡ç†ï¼ˆå·²å®Œæˆï¼‰
2. âœ… è®¾å¤‡æŠ˜æ—§ï¼ˆå·²å®Œæˆï¼‰
3. â³ **æ”¶å…¥ç®¡ç†** - ä¸è®¢å•ç³»ç»Ÿé›†æˆï¼Œè®°å½•é”€å”®æ”¶å…¥
4. â³ **åŸææ–™åº“å­˜ç®¡ç†** - è·Ÿè¸ªåŸææ–™åº“å­˜ï¼Œæ”¯æŒæˆæœ¬æ ¸ç®—
5. â³ **äº§å“æˆæœ¬æ ¸ç®—** - è®¡ç®—äº§å“æˆæœ¬ï¼Œæ”¯æŒåˆ©æ¶¦åˆ†æ

**ä¸­ä¼˜å…ˆçº§ï¼ˆé‡è¦åŠŸèƒ½ï¼‰**ï¼š
6. â³ **åˆ©æ¶¦åˆ†æ** - æ¯›åˆ©ç‡ã€å‡€åˆ©ç‡åˆ†æ
7. â³ **è´¢åŠ¡æŠ¥è¡¨** - æŸç›Šè¡¨ã€èµ„äº§è´Ÿå€ºè¡¨
8. â³ **GSTæŠ¥è¡¨** - å®Œæ•´çš„GSTç”³æŠ¥æ”¯æŒ

**ä½ä¼˜å…ˆçº§ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰**ï¼š
9. â³ **åº”æ”¶è´¦æ¬¾ç®¡ç†** - å¦‚æœæœ‰è´¦æœŸé”€å”®
10. â³ **åº”ä»˜è´¦æ¬¾ç®¡ç†** - å¦‚æœæœ‰è´¦æœŸé‡‡è´­
11. â³ **ç°é‡‘æµç®¡ç†** - ç°é‡‘æµé¢„æµ‹å’Œåˆ†æ
12. â³ **é¢„ç®—ç®¡ç†** - é¢„ç®—åˆ¶å®šå’Œæ‰§è¡Œåˆ†æ

### ä¸ç°æœ‰ç³»ç»Ÿçš„é›†æˆç‚¹

1. **è®¢å•ç³»ç»Ÿé›†æˆ**ï¼š
   - `orders` è¡¨ â†’ `revenues` è¡¨ï¼ˆæ”¶å…¥è®°å½•ï¼‰
   - è®¢å•æ”¯ä»˜æˆåŠŸ â†’ è‡ªåŠ¨åˆ›å»ºæ”¶å…¥è®°å½•
   - è®¢å•é€€æ¬¾ â†’ è‡ªåŠ¨è°ƒæ•´æ”¶å…¥è®°å½•

2. **äº§å“ç³»ç»Ÿé›†æˆ**ï¼š
   - `products` è¡¨ â†’ `product_costs` è¡¨ï¼ˆäº§å“æˆæœ¬ï¼‰
   - `products` è¡¨ â†’ `product_recipes` è¡¨ï¼ˆäº§å“é…æ–¹ï¼‰

3. **åº“å­˜ç³»ç»Ÿé›†æˆ**ï¼š
   - ç°æœ‰ `product_inventory` è¡¨ï¼ˆäº§å“åº“å­˜ï¼‰
   - æ–°å¢ `raw_material_inventory` è¡¨ï¼ˆåŸææ–™åº“å­˜ï¼‰
   - ä¸¤è€…ç‹¬ç«‹ç®¡ç†ï¼Œä½†éƒ½å½±å“æˆæœ¬æ ¸ç®—

