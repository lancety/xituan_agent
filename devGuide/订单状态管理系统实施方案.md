# è®¢å•çŠ¶æ€ç®¡ç†ç³»ç»Ÿå®æ–½æ–¹æ¡ˆ (v2.0)

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ–¹æ¡ˆå®ç°äº†ä¸€ä¸ªåŸºäº**è®¢å•æ‹†åˆ†æ¶æ„**çš„ä¸“ä¸šè®¢å•çŠ¶æ€ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§è®¢å•æ¨¡å¼ï¼ˆæ™®é€šã€å›¢è´­ã€é¢„çº¦ç­‰ï¼‰çš„ç‹¬ç«‹å¤„ç†ï¼Œé€šè¿‡ä»˜æ¬¾çˆ¶å­ç»“æ„å®ç°åˆå¹¶æ”¯ä»˜ï¼Œç¡®ä¿ç³»ç»Ÿæ¶æ„ç®€æ´ã€ä¸šåŠ¡é€»è¾‘æ¸…æ™°ã€ç»´æŠ¤æˆæœ¬ä½ã€‚

### æ ¸å¿ƒè®¾è®¡ç†å¿µ
- ğŸ¯ **è®¢å•ç‹¬ç«‹æ€§**: æ‹†åˆ†åçš„è®¢å•å®Œå…¨ç‹¬ç«‹ï¼Œæ— ä¸šåŠ¡é€»è¾‘å…³è”
- ğŸ”— **ä»˜æ¬¾å…³è”**: é€šè¿‡ä»˜æ¬¾çˆ¶å­ç»“æ„å®ç°å”¯ä¸€å…³è”
- ğŸ—ï¸ **æ¶æ„ç®€æ´**: é¿å…å¤æ‚çš„è®¢å•å…³è”å’ŒçŠ¶æ€èšåˆ
- âš¡ **æ€§èƒ½ä¼˜åŒ–**: æŸ¥è¯¢æ•ˆç‡é«˜ï¼Œæ— è·¨è¡¨å¤æ‚å…³è”
- ğŸ”§ **æ˜“äºç»´æŠ¤**: ä»£ç ç®€å•ï¼ŒèŒè´£æ˜ç¡®

### æ ¸å¿ƒç‰¹æ€§
- âœ… å¤šè®¢å•æ¨¡å¼æ”¯æŒï¼ˆæ™®é€šã€å›¢è´­ã€é¢„çº¦ï¼‰
- âœ… è®¢å•æ‹†åˆ†å’Œç‹¬ç«‹å¤„ç†
- âœ… ä»˜æ¬¾çˆ¶å­ç»“æ„ç®¡ç†
- âœ… çŠ¶æ€è½¬æ¢è§„åˆ™å¼•æ“
- âœ… é˜²é‡å¤æ“ä½œæœºåˆ¶
- âœ… å®Œæ•´çš„çŠ¶æ€è½¬æ¢å†å²è®°å½•
- âœ… ä¸šåŠ¡è§„åˆ™éªŒè¯ï¼ˆæ”¯ä»˜ã€åº“å­˜ã€Offerå¤„ç†ï¼‰
- âœ… å®¡è®¡æ—¥å¿—å’Œåˆè§„æ”¯æŒ
- âœ… å‰ç«¯ç¼–è¾‘ç•Œé¢é›†æˆ

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### è®¢å•æ‹†åˆ†æ¶æ„è®¾è®¡

```
å‰ç«¯æ··åˆè®¢å• â†’ åç«¯æ‹†åˆ†å¤„ç† â†’ ç‹¬ç«‹è®¢å•ç®¡ç†
â”œâ”€â”€ æ™®é€šå•†å“ â†’ æ™®é€šè®¢å• (mode: REGULAR)
â”œâ”€â”€ å›¢è´­å•†å“ â†’ å›¢è´­è®¢å• (mode: OFFER, mode_instance_id: offer_id)
â””â”€â”€ é¢„çº¦å•†å“ â†’ é¢„çº¦è®¢å• (mode: PREORDER, mode_instance_id: preorder_id)
```

### æ•°æ®åº“å±‚è®¾è®¡

#### æ ¸å¿ƒè®¢å•è¡¨
```sql
orders (è®¢å•è¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ order_number (è®¢å•å·)
â”œâ”€â”€ mode (è®¢å•æ¨¡å¼: REGULAR/OFFER/PREORDER)
â”œâ”€â”€ mode_instance_id (æ¨¡å¼å®ä¾‹ID: offer_id/preorder_idç­‰)
â”œâ”€â”€ status (å½“å‰çŠ¶æ€)
â”œâ”€â”€ user_id, total_amount, delivery_fee, final_amount
â”œâ”€â”€ delivery_address_snapshot, note
â”œâ”€â”€ cancel_reason, refund_reason
â””â”€â”€ æ—¶é—´æˆ³å­—æ®µ (created_at, updated_at, paid_atç­‰)

order_items (è®¢å•å•†å“è¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ order_id (å¤–é”®)
â”œâ”€â”€ product_id, quantity, price
â”œâ”€â”€ mode_product_id (æ¨¡å¼å•†å“IDï¼Œå¦‚offer_product_id)
â””â”€â”€ å…¶ä»–å•†å“ä¿¡æ¯
-- æ³¨æ„ï¼šé€šè¿‡çˆ¶çº§order.modeå’Œorder.mode_instance_idè·å–å…³è”ä¿¡æ¯

order_status_transitions (çŠ¶æ€è½¬æ¢è®°å½•è¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ order_id (å¤–é”®)
â”œâ”€â”€ from_status, to_status (çŠ¶æ€è½¬æ¢)
â”œâ”€â”€ transition_type (AUTO/MANUAL/SYSTEM)
â”œâ”€â”€ operator_id (æ“ä½œäºº)
â”œâ”€â”€ reason (å˜æ›´åŸå› )
â”œâ”€â”€ amount (æ¶‰åŠé‡‘é¢)
â”œâ”€â”€ payment_transaction_id (æ”¯ä»˜äº¤æ˜“ID)
â””â”€â”€ created_at, metadata
```

#### ä»˜æ¬¾ç®¡ç†è¡¨
```sql
order_payment_records (ä»˜æ¬¾è®°å½•è¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ parent_payment_id (çˆ¶çº§ä»˜æ¬¾ID - Airwallex Payment Intentï¼Œä¸ºnullè¡¨ç¤ºçˆ¶çº§è®°å½•)
â”œâ”€â”€ order_id (å¤–é”® - å…³è”çš„è®¢å•ID)
â”œâ”€â”€ payment_type (PAYMENT/REFUND/PARTIAL_REFUND)
â”œâ”€â”€ amount, currency, payment_method
â”œâ”€â”€ transaction_id, status
â”œâ”€â”€ refunded_amount (å·²é€€æ¬¾é‡‘é¢)
â”œâ”€â”€ reason, created_at, processed_at
â””â”€â”€ metadata (é¢å¤–ä¿¡æ¯)

-- è¯´æ˜ï¼šæ­¤è¡¨åŒæ—¶ä¿å­˜çˆ¶çº§å’Œå­çº§ä»˜æ¬¾ä¿¡æ¯
-- çˆ¶çº§è®°å½•ï¼šparent_payment_id = nullï¼Œå¯¹åº”Airwallex Payment Intent
-- å­çº§è®°å½•ï¼šparent_payment_id = çˆ¶çº§IDï¼Œå¯¹åº”å…·ä½“è®¢å•çš„ä»˜æ¬¾åˆ†é…

-- ç´¢å¼•ä¼˜åŒ–
CREATE INDEX idx_payment_records_order_id ON order_payment_records(order_id);
CREATE INDEX idx_payment_records_parent_payment_id ON order_payment_records(parent_payment_id);
```

#### åº“å­˜ç®¡ç†è¡¨
```sql
product_inventory (å•†å“åº“å­˜è¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ product_id (å•†å“ID)
â”œâ”€â”€ available_stock (å¯ç”¨åº“å­˜)
â”œâ”€â”€ reserved_stock (é¢„ç•™åº“å­˜)
â”œâ”€â”€ total_stock (æ€»åº“å­˜)
â””â”€â”€ updated_at

inventory_locks (åº“å­˜é”å®šè¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ product_id (å•†å“ID)
â”œâ”€â”€ order_id (è®¢å•ID)
â”œâ”€â”€ quantity (é”å®šæ•°é‡)
â”œâ”€â”€ expires_at (è¿‡æœŸæ—¶é—´)
â””â”€â”€ created_at

inventory_transactions (åº“å­˜äº¤æ˜“è®°å½•è¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ product_id (å•†å“ID)
â”œâ”€â”€ order_id (è®¢å•ID)
â”œâ”€â”€ transaction_type (LOCK/UNLOCK/DEDUCT/RESTORE)
â”œâ”€â”€ quantity (æ•°é‡)
â”œâ”€â”€ status (PENDING/COMPLETED/FAILED)
â””â”€â”€ created_at, processed_at
```

#### è®¢å•æ¨¡å¼è¯´æ˜
```sql
-- æ³¨æ„ï¼šä¸å†éœ€è¦å•ç‹¬çš„offer_ordersè¡¨
-- æ‹†åˆ†åçš„orderæœ¬èº«å°±æ˜¯å®Œæ•´çš„å›¢è´­è®¢å•è®°å½•
-- é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥è¯¢å›¢è´­è®¢å•ï¼š
-- SELECT * FROM orders WHERE mode = 'OFFER' AND mode_instance_id = 'offer_id'
-- SELECT * FROM orders WHERE mode = 'PREORDER' AND mode_instance_id = 'preorder_id'

-- å›¢è´­è®¢å•æŸ¥è¯¢ç¤ºä¾‹
-- è·å–ç‰¹å®šå›¢è´­æ´»åŠ¨çš„æ‰€æœ‰è®¢å•
SELECT * FROM orders 
WHERE mode = 'OFFER' 
AND mode_instance_id = 'offer_123';

-- è·å–ç‰¹å®šé¢„çº¦æ´»åŠ¨çš„æ‰€æœ‰è®¢å•
SELECT * FROM orders 
WHERE mode = 'PREORDER' 
AND mode_instance_id = 'preorder_456';
```

### æœåŠ¡å±‚æ¶æ„

#### æ ¸å¿ƒæœåŠ¡è®¾è®¡
```typescript
OrderStatusService (æ ¸å¿ƒçŠ¶æ€ç®¡ç†æœåŠ¡)
â”œâ”€â”€ transitionOrderStatus() - çŠ¶æ€è½¬æ¢ä¸»å…¥å£
â”œâ”€â”€ validateStatusTransition() - çŠ¶æ€è½¬æ¢éªŒè¯
â”œâ”€â”€ executeBusinessRule() - ä¸šåŠ¡è§„åˆ™æ‰§è¡Œ
â”œâ”€â”€ recordStatusTransition() - è®°å½•çŠ¶æ€è½¬æ¢
â”œâ”€â”€ getOrderStatusHistory() - å†å²è®°å½•æŸ¥è¯¢
â””â”€â”€ sendStatusChangeNotification() - å‘é€é€šçŸ¥

PaymentProcessingService (ä»˜æ¬¾å¤„ç†æœåŠ¡)
â”œâ”€â”€ processPayment() - å¤„ç†ä»˜æ¬¾
â”œâ”€â”€ processRefund() - å¤„ç†é€€æ¬¾
â”œâ”€â”€ getOrderPaymentRecords() - è·å–ä»˜æ¬¾è®°å½•
â””â”€â”€ getRelatedOrders() - é€šè¿‡ä»˜æ¬¾è®°å½•æŸ¥æ‰¾å…³è”è®¢å•

InventoryService (åº“å­˜ç®¡ç†æœåŠ¡)
â”œâ”€â”€ updateInventoryOnPayment() - æ”¯ä»˜æ—¶æ‰£å‡åº“å­˜
â”œâ”€â”€ restoreInventoryOnRefund() - é€€æ¬¾æ—¶æ¢å¤åº“å­˜
â”œâ”€â”€ checkStockAvailability() - æ£€æŸ¥åº“å­˜å¯ç”¨æ€§
â”œâ”€â”€ reserveStock() - é¢„ç•™åº“å­˜
â”œâ”€â”€ releaseReservedStock() - é‡Šæ”¾é¢„ç•™åº“å­˜
â””â”€â”€ getProductStock() - è·å–å•†å“åº“å­˜

OrderModeService (è®¢å•æ¨¡å¼å¤„ç†æœåŠ¡)
â”œâ”€â”€ processOfferOrder() - å¤„ç†å›¢è´­è®¢å•
â”œâ”€â”€ processPreorderOrder() - å¤„ç†é¢„çº¦è®¢å•
â”œâ”€â”€ updateOrderModeOnRefund() - é€€æ¬¾æ—¶æ›´æ–°è®¢å•æ¨¡å¼
â”œâ”€â”€ getOrdersByMode() - æŒ‰æ¨¡å¼è·å–è®¢å•
â”œâ”€â”€ getModeSalesStats() - è·å–æ¨¡å¼é”€å”®ç»Ÿè®¡
â””â”€â”€ processExpiredModeOrders() - å¤„ç†è¿‡æœŸæ¨¡å¼è®¢å•

NotificationService (é€šçŸ¥æœåŠ¡)
â”œâ”€â”€ sendOrderStatusChangeNotification() - å‘é€çŠ¶æ€å˜æ›´é€šçŸ¥
â”œâ”€â”€ sendEmailNotification() - é‚®ä»¶é€šçŸ¥
â”œâ”€â”€ sendSMSNotification() - çŸ­ä¿¡é€šçŸ¥
â””â”€â”€ sendWebSocketNotification() - å®æ—¶é€šçŸ¥
```

### APIå±‚è®¾è®¡

#### è®¢å•ç®¡ç†API
```typescript
// è®¢å•çŠ¶æ€ç®¡ç†
PUT /api/admin/orders/:id/status - æ›´æ–°è®¢å•çŠ¶æ€
POST /api/admin/orders/:id/validate-transition - éªŒè¯çŠ¶æ€è½¬æ¢
GET /api/admin/orders/:id/status-history - è·å–çŠ¶æ€å†å²

// ä»˜æ¬¾ç®¡ç†
POST /api/admin/orders/:id/refund - å¤„ç†é€€æ¬¾
GET /api/admin/orders/:id/payment-records - è·å–ä»˜æ¬¾è®°å½•
GET /api/admin/orders/:id/related-orders - è·å–å…³è”è®¢å•

// è®¢å•æŸ¥è¯¢ï¼ˆé€šç”¨API + æŸ¥è¯¢å‚æ•°ï¼‰
GET /api/admin/orders - è·å–è®¢å•åˆ—è¡¨
â”œâ”€â”€ ?mode=OFFER - è·å–å›¢è´­è®¢å•
â”œâ”€â”€ ?mode=PREORDER - è·å–é¢„çº¦è®¢å•
â”œâ”€â”€ ?mode=REGULAR - è·å–æ™®é€šè®¢å•
â”œâ”€â”€ ?mode=OFFER&mode_instance_id=123 - è·å–ç‰¹å®šå›¢è´­æ´»åŠ¨çš„è®¢å•
â””â”€â”€ ?mode=PREORDER&mode_instance_id=456 - è·å–ç‰¹å®šé¢„çº¦æ´»åŠ¨çš„è®¢å•

// è®¢å•æ¨¡å¼ç®¡ç†
POST /api/admin/orders/split - æ‹†åˆ†æ··åˆè®¢å•
GET /api/admin/orders/mode-stats - è·å–æ¨¡å¼ç»Ÿè®¡

// åº“å­˜ç®¡ç†
GET /api/admin/products/:id/inventory - è·å–å•†å“åº“å­˜
POST /api/admin/products/:id/reserve-stock - é¢„ç•™åº“å­˜
```

---

## ğŸ“Š çŠ¶æ€è½¬æ¢è§„åˆ™

### è®¢å•çŠ¶æ€æšä¸¾
```typescript
enum epOrderStatus {
  PENDING_PAYMENT = 'pending_payment',    // å¾…æ”¯ä»˜
  PAID = 'paid',                          // å·²æ”¯ä»˜
  PROCESSING = 'processing',              // å¤„ç†ä¸­
  READY_FOR_DELIVERY = 'ready_for_delivery', // å¾…å‘è´§
  IN_DELIVERY = 'in_delivery',            // é…é€ä¸­
  DELIVERED = 'delivered',                // å·²é€è¾¾
  CANCELLED = 'cancelled',                // å·²å–æ¶ˆ
  REFUNDED = 'refunded'                   // å·²é€€æ¬¾
}

enum epOrderMode {
  REGULAR = 'REGULAR',      // æ™®é€šè®¢å•
  OFFER = 'OFFER',          // å›¢è´­è®¢å•
  PREORDER = 'PREORDER'     // é¢„çº¦è®¢å•
}
```

### åˆæ³•è½¬æ¢è·¯å¾„
```typescript
const transitions = {
  'pending_payment': ['paid', 'cancelled'],
  'paid': ['processing', 'refunded'],
  'processing': ['ready_for_delivery', 'refunded'],
  'ready_for_delivery': ['in_delivery', 'refunded'],
  'in_delivery': ['delivered', 'refunded'],
  'delivered': ['refunded'],
  'cancelled': [],
  'refunded': []
};
```

### æ—¶é—´çª—å£è§„åˆ™
```typescript
const timeWindows = {
  'pending_payment': 30,    // 30åˆ†é’Ÿå†…å¿…é¡»æ”¯ä»˜
  'processing': 60,         // 1å°æ—¶å†…å¿…é¡»å¼€å§‹å¤„ç†
  'ready_for_delivery': 120, // 2å°æ—¶å†…å¿…é¡»å‘è´§
  'in_delivery': 1440       // 24å°æ—¶å†…å¿…é¡»é€è¾¾
};
```

### ä¸šåŠ¡è§„åˆ™å®šä¹‰
```typescript
enum epBusinessRule {
  VALIDATE_PAYMENT = 'validate_payment',           // éªŒè¯æ”¯ä»˜
  UPDATE_INVENTORY = 'update_inventory',           // æ›´æ–°åº“å­˜
  PROCESS_OFFERS = 'process_offers',               // å¤„ç†å›¢è´­
  PROCESS_REFUND = 'process_refund',               // å¤„ç†é€€æ¬¾
  RESTORE_INVENTORY = 'restore_inventory',         // æ¢å¤åº“å­˜
  UPDATE_OFFERS = 'update_offers',                 // æ›´æ–°å›¢è´­
  SEND_NOTIFICATION = 'send_notification'          // å‘é€é€šçŸ¥
}

const specialTransitions = {
  'pending_payment': {
    'paid': ['validate_payment', 'update_inventory', 'process_offers', 'send_notification']
  },
  'paid': {
    'refunded': ['process_refund', 'restore_inventory', 'update_offers', 'send_notification']
  }
  // ... å…¶ä»–è½¬æ¢è§„åˆ™
};
```

---

## ğŸ”„ è®¢å•æ‹†åˆ†é€»è¾‘è¯¦è§£

### åŸºç¡€æ‹†åˆ†è§„åˆ™
```typescript
// å½“å‰å®ç°ï¼šæŒ‰ç±»å‹æ‹†åˆ†
const splitByType = (items: CartItem[]) => {
  const regular = items.filter(item => !item.offer_id && !item.preorder_id);
  const offers = items.filter(item => item.offer_id);
  const preorders = items.filter(item => item.preorder_id);
  
  return { regular, offers, preorders };
};
```

### ç²¾ç»†åŒ–æ‹†åˆ†è§„åˆ™
```typescript
// æœªæ¥å®ç°ï¼šæŒ‰ç±»å‹ + å®ä¾‹IDåˆ†ç»„
const splitByTypeAndInstance = (items: CartItem[]) => {
  const regular = items.filter(item => !item.offer_id && !item.preorder_id);
  
  // æŒ‰offer_idåˆ†ç»„ï¼ˆä¸åŒå›¢è´­æ´»åŠ¨éœ€è¦æ‹†åˆ†ï¼‰
  const offerGroups = groupBy(items.filter(item => item.offer_id), 'offer_id');
  
  // æŒ‰preorder_idå’Œäº¤è´§æ—¥æœŸåˆ†ç»„ï¼ˆä¸åŒé¢„çº¦æ‰¹æ¬¡éœ€è¦æ‹†åˆ†ï¼‰
  const preorderGroups = groupBy(
    items.filter(item => item.preorder_id), 
    ['preorder_id', 'delivery_date']
  );
  
  return { 
    regular: [regular], 
    offers: Object.values(offerGroups), 
    preorders: Object.values(preorderGroups) 
  };
};

// æ‹†åˆ†ç»“æœç¤ºä¾‹
const splitResult = {
  regular: [/* æ™®é€šå•†å“ */],
  offers: [
    [/* offer_123çš„å•†å“ */],
    [/* offer_456çš„å•†å“ */]
  ],
  preorders: [
    [/* preorder_789 + 2024-01-15çš„å•†å“ */],
    [/* preorder_789 + 2024-01-20çš„å•†å“ */]
  ]
};
```

### æ‹†åˆ†åçš„è®¢å•ç»“æ„
```typescript
// æ™®é€šè®¢å•
const regularOrder = {
  mode: 'REGULAR',
  mode_instance_id: null,
  items: [/* æ™®é€šå•†å“ */]
};

// å›¢è´­è®¢å•ï¼ˆæŒ‰offer_idæ‹†åˆ†ï¼‰
const offerOrders = [
  {
    mode: 'OFFER',
    mode_instance_id: 'offer_123',
    items: [/* offer_123çš„å•†å“ */]
  },
  {
    mode: 'OFFER', 
    mode_instance_id: 'offer_456',
    items: [/* offer_456çš„å•†å“ */]
  }
];

// é¢„çº¦è®¢å•ï¼ˆæŒ‰preorder_id + äº¤è´§æ—¥æœŸæ‹†åˆ†ï¼‰
const preorderOrders = [
  {
    mode: 'PREORDER',
    mode_instance_id: 'preorder_789',
    delivery_date: '2024-01-15',
    items: [/* 2024-01-15äº¤è´§çš„å•†å“ */]
  },
  {
    mode: 'PREORDER',
    mode_instance_id: 'preorder_789', 
    delivery_date: '2024-01-20',
    items: [/* 2024-01-20äº¤è´§çš„å•†å“ */]
  }
];
```

---

## ğŸ”„ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### 1. è®¢å•åˆ›å»ºæµç¨‹

```mermaid
graph TD
    A[å‰ç«¯æ··åˆè®¢å•] --> B[åç«¯è®¢å•æ‹†åˆ†]
    B --> C[æ™®é€šè®¢å• mode=REGULAR]
    B --> D[å›¢è´­è®¢å• mode=OFFER, mode_instance_id=offer_id]
    B --> E[é¢„çº¦è®¢å• mode=PREORDER, mode_instance_id=preorder_id]
    
    C --> F[åˆ›å»ºä»˜æ¬¾è®°å½•]
    D --> F
    E --> F
    
    F --> G[Airwallex Payment Intent çˆ¶çº§è®°å½•]
    F --> H[å„è®¢å•ä»˜æ¬¾åˆ†é… å­çº§è®°å½•]
    
    G --> I[è¿”å›å‰ç«¯æ”¯ä»˜ä¿¡æ¯]
    I --> J[ç”¨æˆ·å®Œæˆæ”¯ä»˜]
    J --> K[æ”¯ä»˜å›è°ƒå¤„ç†]
    K --> L[æ›´æ–°å„è®¢å•çŠ¶æ€]
    L --> M[æ‰§è¡Œä¸šåŠ¡è§„åˆ™]
```

### 2. çŠ¶æ€è½¬æ¢æµç¨‹

```mermaid
graph TD
    A[çŠ¶æ€è½¬æ¢è¯·æ±‚] --> B[éªŒè¯è½¬æ¢åˆæ³•æ€§]
    B --> C{éªŒè¯é€šè¿‡?}
    C -->|å¦| D[è¿”å›é”™è¯¯]
    C -->|æ˜¯| E[æ£€æŸ¥æ—¶é—´çª—å£]
    E --> F{æ—¶é—´çª—å£æœ‰æ•ˆ?}
    F -->|å¦| D
    F -->|æ˜¯| G[æ‰§è¡Œä¸šåŠ¡è§„åˆ™]
    G --> H[æ›´æ–°è®¢å•çŠ¶æ€]
    H --> I[è®°å½•è½¬æ¢å†å²]
    I --> J[å‘é€é€šçŸ¥]
    J --> K[è¿”å›æˆåŠŸ]
```

### 3. é€€æ¬¾å¤„ç†æµç¨‹

```mermaid
graph TD
    A[é€€æ¬¾è¯·æ±‚] --> B[è·å–è®¢å•ä»˜æ¬¾è®°å½•]
    B --> C[éªŒè¯é€€æ¬¾é‡‘é¢]
    C --> D{é‡‘é¢æœ‰æ•ˆ?}
    D -->|å¦| E[è¿”å›é”™è¯¯]
    D -->|æ˜¯| F[è°ƒç”¨Airwallexé€€æ¬¾API]
    F --> G[æ›´æ–°ä»˜æ¬¾è®°å½•]
    G --> H[æ›´æ–°è®¢å•çŠ¶æ€]
    H --> I[æ¢å¤åº“å­˜]
    I --> J[æ›´æ–°å›¢è´­çŠ¶æ€]
    J --> K[å‘é€é€šçŸ¥]
    K --> L[è¿”å›æˆåŠŸ]
```

### 4. å…³è”è®¢å•æŸ¥è¯¢æµç¨‹

```mermaid
graph TD
    A[æŸ¥è¯¢å…³è”è®¢å•] --> B[è·å–è®¢å•ä»˜æ¬¾è®°å½•]
    B --> C[è·å–çˆ¶çº§ä»˜æ¬¾ID]
    C --> D[æŸ¥è¯¢æ‰€æœ‰å­çº§ä»˜æ¬¾è®°å½•]
    D --> E[è·å–å…³è”è®¢å•åˆ—è¡¨]
    E --> F[è¿”å›ç»“æœ]
```

---

## ğŸš€ å®æ–½é˜¶æ®µ

## é˜¶æ®µä¸€ï¼šåŸºç¡€æ¶æ„æ­å»º âœ… å·²å®Œæˆ

### 1.1 æ•°æ®åº“è®¾è®¡
- [x] åˆ›å»º `order_status_transitions` è¡¨
- [x] åˆ›å»º `order_payment_records` è¡¨  
- [x] åˆ›å»º `offer_orders` è¡¨
- [x] åˆ›å»º `product_inventory` è¡¨
- [x] åˆ›å»º `inventory_locks` è¡¨
- [x] åˆ›å»º `inventory_transactions` è¡¨
- [x] ä¿®æ”¹ `orders` è¡¨ç»“æ„ï¼ˆæ·»åŠ  mode, mode_instance_id å­—æ®µï¼‰

### 1.2 ç±»å‹å®šä¹‰
- [x] åˆ›å»º `OrderStatusTransition` ç±»å‹å®šä¹‰
- [x] åˆ›å»º `OrderPaymentRecord` ç±»å‹å®šä¹‰
- [x] åˆ›å»º `OfferOrder` ç±»å‹å®šä¹‰
- [x] åˆ›å»º `ProductInventory` ç±»å‹å®šä¹‰
- [x] åˆ›å»ºçŠ¶æ€è½¬æ¢è§„åˆ™å¸¸é‡
- [x] åˆ›å»ºä¸šåŠ¡è§„åˆ™æšä¸¾

### 1.3 å®ä½“æ³¨å†Œ
- [x] åœ¨ `database.config.ts` ä¸­æ³¨å†Œæ‰€æœ‰æ–°å®ä½“
- [x] ç¡®ä¿ TypeORM èƒ½æ­£ç¡®è¯†åˆ«æ‰€æœ‰å®ä½“
- [x] åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡ä»¶

### 1.4 æ ¸å¿ƒæœåŠ¡
- [x] å®ç° `OrderStatusService` åŸºç¡€ç»“æ„
- [x] å®ç°çŠ¶æ€è½¬æ¢è§„åˆ™å¼•æ“
- [x] å®ç°é˜²é‡å¤æ“ä½œæœºåˆ¶
- [x] å®ç° `PaymentProcessingService` (é›†æˆAirwallex)
- [x] å®ç° `InventoryService` (æ•°æ®åº“é©±åŠ¨)
- [x] å®ç° `OfferOrderService` (å®Œæ•´åŠŸèƒ½)
- [x] å®ç° `NotificationService` (åŸºç¡€åŠŸèƒ½)

### 1.5 APIæ§åˆ¶å™¨
- [x] åˆ›å»º `OrderStatusController`
- [x] å®ç°æ‰€æœ‰çŠ¶æ€ç®¡ç†APIç«¯ç‚¹
- [x] ä¿®æ”¹ `AdminOrderController` é›†æˆçŠ¶æ€ç®¡ç†
- [x] åˆ›å»ºè®¢å•æ‹†åˆ†APIç«¯ç‚¹

### 1.6 å‰ç«¯é›†æˆ
- [x] æ›´æ–°è®¢å•åˆ—è¡¨é¡µé¢æ·»åŠ ç¼–è¾‘æŒ‰é’®
- [x] åˆ›å»ºè®¢å•ç¼–è¾‘æ¨¡æ€æ¡†
- [x] å®ç°çŠ¶æ€é€‰æ‹©å’ŒåŸå› è¾“å…¥
- [x] é›†æˆAPIè°ƒç”¨

---

## é˜¶æ®µäºŒï¼šè®¢å•æ‹†åˆ†æ¶æ„ ğŸ”„ è¿›è¡Œä¸­

### 2.1 è®¢å•æ‹†åˆ†é€»è¾‘
- [ ] å®ç°å‰ç«¯æ··åˆè®¢å•æäº¤
- [ ] å®ç°åç«¯è®¢å•æ‹†åˆ†æœåŠ¡
- [ ] æ·»åŠ è®¢å•æ¨¡å¼è¯†åˆ«é€»è¾‘
- [ ] å®ç°æ¨¡å¼å®ä¾‹IDç®¡ç†
- [ ] å®ç°ç²¾ç»†åŒ–æ‹†åˆ†è§„åˆ™ï¼ˆæŒ‰offer_idå’Œäº¤è´§æ—¥æœŸåˆ†ç»„ï¼‰
- [ ] æ›´æ–°order_itemsè¡¨ç»“æ„ï¼ˆåˆ é™¤offer_idï¼Œæ·»åŠ mode_product_idï¼‰

### 2.2 ä»˜æ¬¾çˆ¶å­ç»“æ„
- [ ] å®ç°ä»˜æ¬¾è®°å½•çˆ¶å­å…³ç³»
- [ ] æ·»åŠ å…³è”è®¢å•æŸ¥è¯¢åŠŸèƒ½
- [ ] å®ç°åˆå¹¶æ”¯ä»˜å¤„ç†
- [ ] æ·»åŠ ä»˜æ¬¾çŠ¶æ€åŒæ­¥

### 2.3 ç‹¬ç«‹è®¢å•å¤„ç†
- [ ] å®ç°å„è®¢å•ç±»å‹ç‹¬ç«‹çŠ¶æ€ç®¡ç†
- [ ] æ·»åŠ è®¢å•ç±»å‹ç‰¹å®šä¸šåŠ¡è§„åˆ™
- [ ] å®ç°ç‹¬ç«‹åº“å­˜ç®¡ç†
- [ ] æ·»åŠ ç‹¬ç«‹é€šçŸ¥å¤„ç†
- [ ] åˆ é™¤offer_ordersè¡¨ï¼ˆä¸å†éœ€è¦ï¼‰
- [ ] æ›´æ–°APIä¸ºé€šç”¨æŸ¥è¯¢å‚æ•°æ¨¡å¼

### 2.4 é€€æ¬¾åè°ƒæœºåˆ¶
- [ ] å®ç°åŸºäºä»˜æ¬¾è®°å½•çš„é€€æ¬¾
- [ ] æ·»åŠ éƒ¨åˆ†é€€æ¬¾æ”¯æŒ
- [ ] å®ç°é€€æ¬¾é‡‘é¢åˆ†é…
- [ ] æ·»åŠ é€€æ¬¾å†å²æŸ¥è¯¢

---

## é˜¶æ®µä¸‰ï¼šé«˜çº§åŠŸèƒ½ ğŸ¯ è®¡åˆ’ä¸­

### 3.1 æƒé™ç®¡ç†
- [ ] å®ç°åŸºäºè§’è‰²çš„çŠ¶æ€è½¬æ¢æƒé™
- [ ] æ·»åŠ æ“ä½œå®¡æ‰¹æµç¨‹
- [ ] å®ç°å¤šçº§æƒé™æ§åˆ¶
- [ ] æ·»åŠ è®¢å•ç±»å‹ç‰¹å®šæƒé™

### 3.2 å®¡è®¡å’Œåˆè§„
- [ ] å®Œå–„å®¡è®¡æ—¥å¿—è®°å½•
- [ ] å®ç°æ•°æ®åŠ å¯†
- [ ] æ·»åŠ åˆè§„æŠ¥å‘Šç”Ÿæˆ
- [ ] å®ç°æ•°æ®å¤‡ä»½å’Œæ¢å¤

### 3.3 æ€§èƒ½ä¼˜åŒ–
- [ ] å®ç°Redisç¼“å­˜
- [ ] æ·»åŠ æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- [ ] å®ç°å¼‚æ­¥å¤„ç†é˜Ÿåˆ—
- [ ] æ·»åŠ ç›‘æ§å’Œå‘Šè­¦

### 3.4 é«˜çº§åŠŸèƒ½
- [ ] å®ç°æ‰¹é‡çŠ¶æ€æ›´æ–°
- [ ] æ·»åŠ çŠ¶æ€è½¬æ¢æ¨¡æ¿
- [ ] å®ç°è‡ªåŠ¨åŒ–å·¥ä½œæµ
- [ ] æ·»åŠ æ•°æ®åˆ†æé¢æ¿

---

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„è®¢å•æ¨¡å¼

1. **æ›´æ–°è®¢å•æ¨¡å¼æšä¸¾**
```typescript
// åœ¨ order.type.ts ä¸­æ·»åŠ æ–°æ¨¡å¼
export enum epOrderMode {
  // ... ç°æœ‰æ¨¡å¼
  NEW_MODE = 'NEW_MODE'
}
```

2. **æ·»åŠ æ¨¡å¼ç‰¹å®šä¸šåŠ¡è§„åˆ™**
```typescript
// åœ¨ order-status-rules.enum.ts ä¸­æ·»åŠ è§„åˆ™
export const ORDER_MODE_RULES = {
  [epOrderMode.NEW_MODE]: {
    transitions: { /* ç‰¹å®šè½¬æ¢è§„åˆ™ */ },
    businessRules: { /* ç‰¹å®šä¸šåŠ¡è§„åˆ™ */ }
  }
};
```

3. **å®ç°æ¨¡å¼ç‰¹å®šæœåŠ¡**
```typescript
// åˆ›å»ºæ–°æ¨¡å¼çš„æœåŠ¡
class NewModeOrderService {
  async processNewModeOrder(order: Order) {
    // å®ç°æ–°æ¨¡å¼ç‰¹å®šé€»è¾‘
  }
}
```

### æ·»åŠ æ–°çš„çŠ¶æ€è½¬æ¢è§„åˆ™

1. **æ›´æ–°çŠ¶æ€æšä¸¾**
```typescript
export enum epOrderStatus {
  // ... ç°æœ‰çŠ¶æ€
  NEW_STATUS = 'new_status'
}
```

2. **æ›´æ–°è½¬æ¢è§„åˆ™**
```typescript
export const ORDER_STATUS_RULES = {
  transitions: {
    // ... ç°æœ‰è§„åˆ™
    [epOrderStatus.EXISTING_STATUS]: [epOrderStatus.NEW_STATUS]
  }
};
```

3. **æ·»åŠ ä¸šåŠ¡é€»è¾‘**
```typescript
private async executeBusinessRule(rule: epBusinessRule, order: Order, newStatus: epOrderStatus) {
  switch (rule) {
    case epBusinessRule.NEW_BUSINESS_RULE:
      // å®ç°æ–°çš„ä¸šåŠ¡é€»è¾‘
      break;
  }
}
```

### æ·»åŠ æ–°çš„APIç«¯ç‚¹

1. **åœ¨æ§åˆ¶å™¨ä¸­æ·»åŠ æ–¹æ³•**
```typescript
async newEndpoint(req: Request, res: Response) {
  try {
    const { orderId } = req.params;
    const result = await this.orderStatusService.newMethod(orderId);
    res.json({ success: true, data: result });
  } catch (error) {
    res.status(400).json({ success: false, message: error.message });
  }
}
```

2. **åœ¨è·¯ç”±ä¸­æ³¨å†Œ**
```typescript
router.get('/new-endpoint/:orderId', orderStatusController.newEndpoint.bind(orderStatusController));
```

### æ•°æ®åº“è¿ç§»

1. **åˆ›å»ºè¿ç§»æ–‡ä»¶**
```sql
-- migrations/YYYYMMDDHHMMSS_description.sql
CREATE TABLE new_table (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  -- å…¶ä»–å­—æ®µ
);

-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_new_table_field ON new_table(field);
```

2. **è¿è¡Œè¿ç§»**
```bash
cd xituan_backend
npm run migrate:dev
```

---

## ğŸ§ª æµ‹è¯•æŒ‡å—

### å•å…ƒæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•
npm test -- --grep "OrderStatusService"
npm test -- --grep "PaymentProcessingService"
```

### APIæµ‹è¯•
```bash
# æµ‹è¯•çŠ¶æ€æ›´æ–°
curl -X PUT http://localhost:3050/api/admin/orders/{orderId}/status \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer {token}" \
  -d '{"toStatus":"paid","reason":"æµ‹è¯•"}'

# æµ‹è¯•å…³è”è®¢å•æŸ¥è¯¢
curl -X GET http://localhost:3050/api/admin/orders/{orderId}/related-orders \
  -H "Authorization: Bearer {token}"

# æµ‹è¯•é€€æ¬¾å¤„ç†
curl -X POST http://localhost:3050/api/admin/orders/{orderId}/refund \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer {token}" \
  -d '{"amount":100,"reason":"æµ‹è¯•é€€æ¬¾"}'
```

### å‰ç«¯æµ‹è¯•
1. å¯åŠ¨CMS: `cd xituan_cms && npm run dev`
2. è®¿é—®è®¢å•ç®¡ç†é¡µé¢
3. æµ‹è¯•è®¢å•ç¼–è¾‘åŠŸèƒ½
4. æµ‹è¯•çŠ¶æ€æ›´æ–°åŠŸèƒ½

---

## ğŸ“ å¸¸è§é—®é¢˜

### Q: è®¢å•æ‹†åˆ†åå¦‚ä½•æŸ¥è¯¢å…³è”è®¢å•ï¼Ÿ
A: ä½¿ç”¨ä»¥ä¸‹APIï¼š
```bash
GET /api/admin/orders/{orderId}/related-orders
```
ç³»ç»Ÿä¼šé€šè¿‡ä»˜æ¬¾è®°å½•è‡ªåŠ¨æŸ¥æ‰¾æ‰€æœ‰å…³è”è®¢å•ã€‚

### Q: å¦‚ä½•æŸ¥è¯¢ç‰¹å®šç±»å‹çš„è®¢å•ï¼Ÿ
A: ä½¿ç”¨é€šç”¨API + æŸ¥è¯¢å‚æ•°ï¼š
```bash
# æŸ¥è¯¢æ‰€æœ‰å›¢è´­è®¢å•
GET /api/admin/orders?mode=OFFER

# æŸ¥è¯¢ç‰¹å®šå›¢è´­æ´»åŠ¨çš„è®¢å•
GET /api/admin/orders?mode=OFFER&mode_instance_id=123

# æŸ¥è¯¢é¢„çº¦è®¢å•
GET /api/admin/orders?mode=PREORDER
```

### Q: å¦‚ä½•å¤„ç†æ··åˆè®¢å•çš„é€€æ¬¾ï¼Ÿ
A: æ¯ä¸ªè®¢å•ç‹¬ç«‹å¤„ç†é€€æ¬¾ï¼š
1. ç³»ç»Ÿé€šè¿‡ä»˜æ¬¾è®°å½•æ‰¾åˆ°çˆ¶çº§ä»˜æ¬¾ä¿¡æ¯
2. è°ƒç”¨Airwallex APIè¿›è¡Œéƒ¨åˆ†é€€æ¬¾
3. æ›´æ–°å¯¹åº”è®¢å•çš„çŠ¶æ€å’Œä»˜æ¬¾è®°å½•
4. å…¶ä»–è®¢å•ä¸å—å½±å“

### Q: ä¸åŒè®¢å•ç±»å‹çš„åº“å­˜å¦‚ä½•ç®¡ç†ï¼Ÿ
A: æ¯ç§è®¢å•ç±»å‹ç‹¬ç«‹ç®¡ç†åº“å­˜ï¼š
- æ™®é€šè®¢å•ï¼šä½¿ç”¨å¸¸è§„åº“å­˜
- å›¢è´­è®¢å•ï¼šä½¿ç”¨å›¢è´­ä¸“ç”¨åº“å­˜
- é¢„çº¦è®¢å•ï¼šä½¿ç”¨é¢„çº¦åº“å­˜
- å„ç±»å‹ä¹‹é—´æ— ä¾èµ–å…³ç³»

### Q: ä¸ºä»€ä¹ˆä¸éœ€è¦offer_ordersè¡¨ï¼Ÿ
A: æ‹†åˆ†åçš„orderæœ¬èº«å°±æ˜¯å®Œæ•´çš„å›¢è´­è®¢å•è®°å½•ï¼š
- é€šè¿‡order.mode = 'OFFER'å’Œorder.mode_instance_idå¯ä»¥æŸ¥è¯¢
- ä¸éœ€è¦é¢å¤–çš„å…³è”è¡¨
- ç®€åŒ–äº†æ•°æ®ç»“æ„å’ŒæŸ¥è¯¢é€»è¾‘

### Q: å¦‚ä½•æ·»åŠ æ–°çš„è®¢å•æ¨¡å¼ï¼Ÿ
A: æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ï¼š
1. åœ¨ `epOrderMode` æšä¸¾ä¸­æ·»åŠ æ–°æ¨¡å¼
2. åœ¨ `ORDER_MODE_RULES` ä¸­å®šä¹‰ç‰¹å®šè§„åˆ™
3. åˆ›å»ºå¯¹åº”çš„æœåŠ¡ç±»
4. å®ç°æ¨¡å¼ç‰¹å®šçš„ä¸šåŠ¡é€»è¾‘

### Q: çŠ¶æ€è½¬æ¢å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. çŠ¶æ€è½¬æ¢è·¯å¾„æ˜¯å¦åˆæ³•
2. æ—¶é—´çª—å£æ˜¯å¦è¶…æ—¶
3. ä¸šåŠ¡è§„åˆ™éªŒè¯æ˜¯å¦é€šè¿‡
4. æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸
5. è®¢å•æ¨¡å¼æ˜¯å¦æ”¯æŒè¯¥è½¬æ¢

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

### åç«¯æ ¸å¿ƒæ–‡ä»¶
- `src/domains/order/services/order-status.service.ts` - æ ¸å¿ƒçŠ¶æ€ç®¡ç†æœåŠ¡
- `src/domains/order/services/order-split.service.ts` - è®¢å•æ‹†åˆ†æœåŠ¡
- `src/domains/order/controllers/order-status.controller.ts` - APIæ§åˆ¶å™¨
- `src/domains/order/controllers/admin-order.controller.ts` - ç®¡ç†ç«¯æ§åˆ¶å™¨
- `src/domains/payment/services/payment-processing.service.ts` - ä»˜æ¬¾å¤„ç†æœåŠ¡
- `src/domains/inventory/services/inventory.service.ts` - åº“å­˜ç®¡ç†æœåŠ¡
- `src/domains/order/services/order-mode.service.ts` - è®¢å•æ¨¡å¼å¤„ç†æœåŠ¡

### æ•°æ®åº“å®ä½“
- `src/domains/order/domain/order-status-transition.entity.ts` - çŠ¶æ€è½¬æ¢å®ä½“
- `src/domains/order/domain/order-payment-record.entity.ts` - ä»˜æ¬¾è®°å½•å®ä½“
- `src/domains/inventory/domain/product-inventory.entity.ts` - åº“å­˜å®ä½“
- `src/domains/inventory/domain/inventory-lock.entity.ts` - åº“å­˜é”å®šå®ä½“
- `src/domains/inventory/domain/inventory-transaction.entity.ts` - åº“å­˜äº¤æ˜“å®ä½“

### å‰ç«¯æ–‡ä»¶
- `src/pages/orders.tsx` - è®¢å•åˆ—è¡¨é¡µé¢
- `src/components/orders/OrderEditModal.tsx` - è®¢å•ç¼–è¾‘æ¨¡æ€æ¡†
- `src/lib/api/order.api.ts` - APIå®¢æˆ·ç«¯

### é…ç½®æ–‡ä»¶
- `migrations/` - æ•°æ®åº“è¿ç§»æ–‡ä»¶
- `submodules/xituan_codebase/typing_entity/` - ç±»å‹å®šä¹‰
- `submodules/xituan_codebase/constants/` - å¸¸é‡å®šä¹‰

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯ä»¥åšçš„
1. æµ‹è¯•ç°æœ‰çš„çŠ¶æ€è½¬æ¢åŠŸèƒ½
2. éªŒè¯å‰ç«¯ç¼–è¾‘ç•Œé¢
3. æ£€æŸ¥æ•°æ®åº“è®°å½•å®Œæ•´æ€§
4. æµ‹è¯•è®¢å•æ‹†åˆ†é€»è¾‘

### çŸ­æœŸè®¡åˆ’ (1-2å‘¨)
1. å®Œå–„è®¢å•æ‹†åˆ†æ¶æ„
2. å®ç°ä»˜æ¬¾çˆ¶å­ç»“æ„
3. æ·»åŠ å…³è”è®¢å•æŸ¥è¯¢
4. å®Œå–„é€€æ¬¾åè°ƒæœºåˆ¶

### ä¸­æœŸè®¡åˆ’ (1ä¸ªæœˆ)
1. å®Œå–„æƒé™ç®¡ç†
2. æ·»åŠ å®¡è®¡åŠŸèƒ½
3. æ€§èƒ½ä¼˜åŒ–
4. æ·»åŠ ç›‘æ§å‘Šè­¦

### é•¿æœŸè®¡åˆ’ (3ä¸ªæœˆ)
1. é«˜çº§å·¥ä½œæµåŠŸèƒ½
2. æ•°æ®åˆ†æé¢æ¿
3. ç§»åŠ¨ç«¯æ”¯æŒ
4. å¤šè¯­è¨€æ”¯æŒ

---

## ğŸ” æ¶æ„ä¼˜åŠ¿æ€»ç»“

### 1. ç®€æ´æ€§ â­â­â­â­â­
- è®¢å•å®Œå…¨ç‹¬ç«‹ï¼Œæ— å¤æ‚å…³è”
- é€šè¿‡ä»˜æ¬¾è®°å½•å®ç°å”¯ä¸€å…³è”
- é¿å…çŠ¶æ€èšåˆçš„å¤æ‚æ€§
- ä»£ç ç»´æŠ¤æˆæœ¬ä½

### 2. æ¸…æ™°æ€§ â­â­â­â­â­
- ä¸šåŠ¡é€»è¾‘æ¸…æ™°ï¼ŒèŒè´£æ˜ç¡®
- æ¯ç§è®¢å•ç±»å‹ç‹¬ç«‹å¤„ç†
- é€€æ¬¾æŒ‰è®¢å•ç‹¬ç«‹å¤„ç†
- ç³»ç»Ÿè¾¹ç•Œæ¸…æ™°

### 3. å¯æ‰©å±•æ€§ â­â­â­â­â­
- æ–°å¢è®¢å•ç±»å‹å®¹æ˜“
- æ–°å¢ä¸šåŠ¡è§„åˆ™ç®€å•
- æ”¯æŒå¤šç§æ”¯ä»˜æ–¹å¼
- æ”¯æŒå¤šç§é€šçŸ¥æ¸ é“

### 4. æ€§èƒ½ â­â­â­â­â­
- æŸ¥è¯¢æ•ˆç‡é«˜
- æ— è·¨è¡¨å¤æ‚å…³è”
- æ”¯æŒç¼“å­˜ä¼˜åŒ–
- æ”¯æŒå¼‚æ­¥å¤„ç†

### 5. å¯ç»´æŠ¤æ€§ â­â­â­â­â­
- ä»£ç ç»“æ„æ¸…æ™°
- æµ‹è¯•è¦†ç›–å®Œæ•´
- æ–‡æ¡£è¯¦ç»†å‡†ç¡®
- é”™è¯¯å¤„ç†å®Œå–„

---

*æœ€åæ›´æ–°: 2025-01-12*
*ç‰ˆæœ¬: 2.1.0*
*çŠ¶æ€: é˜¶æ®µä¸€å®Œæˆï¼Œé˜¶æ®µäºŒè¿›è¡Œä¸­*
*æ¶æ„: è®¢å•æ‹†åˆ† + ä»˜æ¬¾çˆ¶å­ç»“æ„ + ç²¾ç»†åŒ–æ‹†åˆ†è§„åˆ™*
*æ›´æ–°: ä¿®æ­£è¡¨ç»“æ„è®¾è®¡ï¼Œåˆ é™¤å†—ä½™è¡¨ï¼Œä¼˜åŒ–APIè®¾è®¡*